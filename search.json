[{"path":"https://stscl.github.io/spEDM/articles/GCCM.html","id":"methodological-background","dir":"Articles","previous_headings":"","what":"Methodological Background","title":"Geographical Convergent Cross Mapping","text":"Let \\(Y = \\{y_i\\}\\) \\(X = \\{x_i\\}\\) two spatial cross sectional variable, \\(= 1, 2, \\dots, n\\) denotes spatial units (e.g., regions grid cells), shadow manifolds \\(X\\) can constructed using different spatial lag values spatial units: \\[ M_{x} = \\begin{bmatrix} S_{(\\tau)}(x_1) & S_{(2\\tau)}(x_1) & \\cdots & S_{(E\\tau)}(x_1) \\\\ S_{(\\tau)}(x_2) & S_{(2\\tau)}(x_2) & \\cdots & S_{(E\\tau)}(x_2) \\\\ \\vdots & \\vdots & \\ddots & \\vdots \\\\ S_{(\\tau)}(x_n) & S_{(2\\tau)}(x_n) & \\cdots & S_{(E\\tau)}(x_n) \\end{bmatrix} \\] , \\(S_{(j)}(x_i)\\) denotes \\(j\\) th-order spatial lag value spatial unit \\(\\), \\(\\tau\\) step size spatial lag order, \\(E\\) embedding dimension \\(M_{x}\\) corresponds shadow manifolds \\(X\\). reconstructed shadow manifolds \\(M_{x}\\), state Y can predicted state X \\[ \\hat{Y}_s \\mid M_x = \\sum\\limits_{=1}^k \\left(\\omega_{si}Y_{si} \\mid M_x \\right) \\] \\(s\\) represents spatial unit value \\(Y\\) needs predicted, \\(\\hat{Y}_s\\) prediction result, \\(k\\) number nearest neighbors used prediction, \\(si\\) spatial unit used prediction, \\(Y_{si}\\) observation value \\(Y\\) \\(si\\). \\(\\omega_{si}\\) corresponding weight defined : \\[ \\omega_{si} \\mid M_x = \\frac{weight \\left(\\psi\\left(M_x,s_i\\right),\\psi\\left(M_x,s\\right)\\right)}{\\sum_{=1}^{L+1}weight \\left(\\psi\\left(M_x,s_i\\right),\\psi\\left(M_x,s\\right)\\right)} \\] \\(\\psi(M_x, s_i)\\) state vector spatial unit \\(s_i\\) shadow manifold $ M_x$, \\(weight (\\ast, \\ast)\\) weight function two states shadow manifold, defined : \\[ weight \\left(\\psi\\left(M_x,s_i\\right),\\psi\\left(M_x,s\\right)\\right) = \\exp \\left(- \\frac{dis \\left(\\psi\\left(M_x,s_i\\right),\\psi\\left(M_x,s\\right)\\right)}{dis \\left(\\psi\\left(M_x,s_1\\right),\\psi\\left(M_x,s\\right)\\right)} \\right) \\] \\(\\exp\\) exponential function \\(dis \\left(\\ast,\\ast\\right)\\) represents distance function two states shadow manifold defined : \\[ dis \\left( \\psi(M_x, s_i), \\psi(M_x, s) \\right) = \\frac{1}{E} \\sum_{m=1}^{E} \\left| \\psi_m(M_x, s_i) - \\psi_m(M_x, s) \\right| \\] \\(dis \\left( \\psi(M_x, s_i), \\psi(M_x, s) \\right)\\) denotes average absolute difference corresponding elements two state vectors shadow manifold \\(M_x\\), \\(E\\) embedding dimension, \\(\\psi_m(M_x, s_i)\\) \\(m\\)-th element state vector \\(\\psi(M_x, s_i)\\). skill cross-mapping prediction \\(\\rho\\) measured Pearson correlation coefficient true observations corresponding predictions, confidence interval \\(\\rho\\) can estimated based \\(z\\)-statistics normal distribution: \\[ \\rho = \\frac{Cov\\left(Y,\\hat{Y}\\mid M_x\\right)}{\\sqrt{Var\\left(Y\\right) Var\\left(\\hat{Y}\\mid M_x\\right)}} \\] \\[ t = \\rho \\sqrt{\\frac{n-2}{1-\\rho^2}} \\] \\(n\\) number observations predicted, \\[ z = \\frac{1}{2} \\ln \\left(\\frac{1+\\rho}{1-\\rho}\\right) \\] prediction skill \\(\\rho\\) varies setting different sizes libraries, means quantity observations used reconstruction shadow manifold. can use convergence \\(\\rho\\) infer causal associations. GCCM, convergence means \\(\\rho\\) increases size libraries statistically significant library becomes largest. \\[ \\rho_{x \\y} = \\lim_{L \\\\infty} cor \\left( Y,\\hat{Y}\\mid M_x \\right) \\] \\(\\rho_{x \\y}\\) correlation convergence, used measure causation effect \\(Y\\) \\(X\\), despite notation suggesting reverse direction.","code":""},{"path":[]},{"path":"https://stscl.github.io/spEDM/articles/GCCM.html","id":"an-example-of-spatial-lattice-data","dir":"Articles","previous_headings":"Usage examples","what":"An example of spatial lattice data","title":"Geographical Convergent Cross Mapping","text":"Load spEDM package county-level population density data: Determining optimal embedding dimension: Run GCCM: Visualize result:","code":"library(spEDM)  popd_nb = spdep::read.gal(system.file(\"case/popd_nb.gal\",package = \"spEDM\")) ## Warning in spdep::read.gal(system.file(\"case/popd_nb.gal\", package = \"spEDM\")): ## neighbour object has 4 sub-graphs popd = readr::read_csv(system.file(\"case/popd.csv\",package = \"spEDM\")) ## Rows: 2806 Columns: 7 ## ── Column specification ──────────────────────────────────────────────────────── ## Delimiter: \",\" ## dbl (7): lon, lat, popd, elev, tem, pre, slope ##  ## ℹ Use `spec()` to retrieve the full column specification for this data. ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message. popd_sf = sf::st_as_sf(popd, coords = c(\"lon\",\"lat\"), crs = 4326) popd_sf ## Simple feature collection with 2806 features and 5 fields ## Geometry type: POINT ## Dimension:     XY ## Bounding box:  xmin: 74.9055 ymin: 18.2698 xmax: 134.269 ymax: 52.9346 ## Geodetic CRS:  WGS 84 ## # A tibble: 2,806 × 6 ##     popd  elev   tem   pre slope          geometry ##  * <dbl> <dbl> <dbl> <dbl> <dbl>       <POINT [°]> ##  1  780.     8  17.4 1528. 0.452 (116.912 30.4879) ##  2  395.    48  17.2 1487. 0.842 (116.755 30.5877) ##  3  261.    49  16.0 1456. 3.56  (116.541 30.7548) ##  4  258.    23  17.4 1555. 0.932  (116.241 30.104) ##  5  211.   101  16.3 1494. 3.34   (116.173 30.495) ##  6  386.    10  16.6 1382. 1.65  (116.935 30.9839) ##  7  350.    23  17.5 1569. 0.346 (116.677 30.2412) ##  8  470.    22  17.1 1493. 1.88  (117.066 30.6514) ##  9 1226.    11  17.4 1526. 0.208 (117.171 30.5558) ## 10  137.   598  13.9 1458. 5.92  (116.208 30.8983) ## # ℹ 2,796 more rows simplex(popd_sf, \"pre\", \"pre\", E = 2:10, k = 6) ## The suggested E and k for variable pre is 3 and 6 simplex(popd_sf, \"popd\", \"popd\", E = 2:10, k = 6) ## The suggested E and k for variable popd is 9 and 6 startTime = Sys.time() pd_res = gccm(data = popd_sf,               cause = \"pre\",               effect = \"popd\",               libsizes = seq(100, 2800, by = 200),               E = c(3,9),               k = 6,               nb = popd_nb,               progressbar = FALSE) endTime = Sys.time() print(difftime(endTime,startTime, units =\"mins\")) ## Time difference of 1.863025 mins pd_res ##    libsizes pre->popd  popd->pre ## 1       100 0.1140592 0.03269659 ## 2       300 0.2324104 0.06451333 ## 3       500 0.3000403 0.09424558 ## 4       700 0.3576318 0.12213856 ## 5       900 0.4023234 0.14794178 ## 6      1100 0.4449998 0.17006265 ## 7      1300 0.4888766 0.19055016 ## 8      1500 0.5289804 0.21034768 ## 9      1700 0.5720495 0.22720335 ## 10     1900 0.6122726 0.24169609 ## 11     2100 0.6506091 0.25473781 ## 12     2300 0.6863609 0.26493519 ## 13     2500 0.7203389 0.27377272 ## 14     2700 0.7519251 0.28118969 plot(pd_res, xlimits = c(0, 2800), draw_ci = TRUE) +   ggplot2::theme(legend.justification = c(0.65,1))"},{"path":"https://stscl.github.io/spEDM/articles/GCCM.html","id":"an-example-of-spatial-grid-data","dir":"Articles","previous_headings":"Usage examples","what":"An example of spatial grid data","title":"Geographical Convergent Cross Mapping","text":"Load spEDM package farmland NPP data: Determining optimal embedding dimension: Run GCCM: Visualize result:","code":"library(spEDM)  npp = terra::rast(system.file(\"case/npp.tif\", package = \"spEDM\")) # To save the computation time, we will aggregate the data by 3 times npp = terra::aggregate(npp, fact = 3, na.rm = TRUE) npp ## class       : SpatRaster  ## size        : 135, 161, 5  (nrow, ncol, nlyr) ## resolution  : 30000, 30000  (x, y) ## extent      : -2625763, 2204237, 1867078, 5917078  (xmin, xmax, ymin, ymax) ## coord. ref. : CGCS2000_Albers  ## source(s)   : memory ## names       :      npp,        pre,      tem,      elev,         hfp  ## min values  :   187.50,   390.3351, -47.8194, -110.1494,  0.04434316  ## max values  : 15381.89, 23734.5330, 262.8576, 5217.6431, 42.68803711  # Inspect NA values terra::global(npp,\"isNA\") ##       isNA ## npp  14815 ## pre  14766 ## tem  14766 ## elev 14760 ## hfp  14972 terra::ncell(npp) ## [1] 21735 nnamat = terra::as.matrix(npp[[1]], wide = TRUE) nnaindice = which(!is.na(nnamat), arr.ind = TRUE) dim(nnaindice) ## [1] 6920    2  # Select 1500 non-NA pixels to predict: set.seed(2025) indices = sample(nrow(nnaindice), size = 1500, replace = FALSE) libindice = nnaindice[-indices,] predindice = nnaindice[indices,] simplex(npp, \"pre\", \"pre\", E = 2:10, k = 8, lib = nnaindice, pred = predindice) ## The suggested E and k for variable pre is 2 and 8 simplex(npp, \"npp\", \"npp\", E = 2:10, k = 8, lib = nnaindice, pred = predindice) ## The suggested E and k for variable npp is 10 and 8 startTime = Sys.time() npp_res = gccm(data = npp,                cause = \"pre\",                effect = \"npp\",                libsizes = matrix(rep(seq(10,130,20),2),ncol = 2),                E = c(2,10),                k = 8,                lib = nnaindice,                pred = predindice,                progressbar = FALSE) endTime = Sys.time() print(difftime(endTime,startTime, units =\"mins\")) ## Time difference of 0.9523582 mins npp_res ##   libsizes  pre->npp  npp->pre ## 1       10 0.1282926 0.1111690 ## 2       30 0.2600225 0.2346917 ## 3       50 0.3773586 0.2998472 ## 4       70 0.4968706 0.3411285 ## 5       90 0.5975915 0.3393013 ## 6      110 0.7362461 0.3434810 ## 7      130 0.8385761 0.3633303 plot(npp_res,xlimits = c(5, 135),ylimits = c(0.05,1), draw_ci = TRUE) +   ggplot2::theme(legend.justification = c(0.25,1))"},{"path":"https://stscl.github.io/spEDM/articles/GCMC.html","id":"methodological-background","dir":"Articles","previous_headings":"","what":"Methodological Background","title":"Geographical Cross Mapping Cardinality","text":"measure causal strengths spatial cross-sectional data, GCMC (Geographical Cross Mapping Cardinality) employs three-stage procedure: Stage one involves reconstructing state space. Given two spatial variables, \\(x\\) \\(y\\), step requires determining suitable embedding dimension \\(E\\) spatial lag interval \\(\\tau\\). spatial location (unit) \\(\\), attribute values spatial neighbors lag orders \\(\\tau, 2\\tau, \\dots, E\\tau\\) collected. values summarized—commonly using mean—construct embedding vector unit. Aggregating vectors across spatial units results reconstructed state spaces, denoted \\(E_x\\) \\(E_y\\). Stage two constructs Intersectional Cardinality (IC) curve, serves evaluate causal strength. measure whether \\(y\\) causally affects \\(x\\), one computes, \\(k\\), overlap \\(k\\) nearest neighbors \\(E_y\\) corresponding “projected” neighbors traced \\(E_x\\). Specifically, point \\(E_x\\), \\(k\\) nearest neighbors identified, mapped neighbors \\(E_y\\) compared direct neighbors \\(E_y\\). IC curve formed recording number shared neighbors across range \\(k = 1, 2, \\dots, n\\). process can also reversed test causality \\(x\\) \\(y\\). Stage three involves quantifying validating causal strengths. area IC curve (AUC) provides numerical measure causal strength. determine whether observed causal strength statistically significant, hypothesis test performed: null assumes causality, alternative assumes presence. DeLong palcements method applied evaluate difference AUCs hypotheses. also yields confidence intervals, supporting robust causal inference.","code":""},{"path":[]},{"path":"https://stscl.github.io/spEDM/articles/GCMC.html","id":"an-example-of-spatial-lattice-data","dir":"Articles","previous_headings":"Usage examples","what":"An example of spatial lattice data","title":"Geographical Cross Mapping Cardinality","text":"Load spEDM package county-level population density data: false nearest neighbours (FNN) method helps identify appropriate embedding dimension reconstructing state space time series spatial cross-sectional data. low embedding dimension minimizes false neighbours considered optimal. false nearest neighbours (FNN) ratio decreased approximately 0.3 embedding dimension E reached 10, remained relatively stable thereafter. Therefore, adopted \\(E = 10\\) embedding dimension subsequent GCMC analysis. , run GCMC: define two functions process results plot causal strengths matrix. Organize results long table: Visualize result:","code":"library(spEDM)  popd_nb = spdep::read.gal(system.file(\"case/popd_nb.gal\",package = \"spEDM\")) ## Warning in spdep::read.gal(system.file(\"case/popd_nb.gal\", package = \"spEDM\")): ## neighbour object has 4 sub-graphs popd = readr::read_csv(system.file(\"case/popd.csv\",package = \"spEDM\")) ## Rows: 2806 Columns: 7 ## ── Column specification ──────────────────────────────────────────────────────── ## Delimiter: \",\" ## dbl (7): lon, lat, popd, elev, tem, pre, slope ##  ## ℹ Use `spec()` to retrieve the full column specification for this data. ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message. popd_sf = sf::st_as_sf(popd, coords = c(\"lon\",\"lat\"), crs = 4326) popd_sf ## Simple feature collection with 2806 features and 5 fields ## Geometry type: POINT ## Dimension:     XY ## Bounding box:  xmin: 74.9055 ymin: 18.2698 xmax: 134.269 ymax: 52.9346 ## Geodetic CRS:  WGS 84 ## # A tibble: 2,806 × 6 ##     popd  elev   tem   pre slope          geometry ##  * <dbl> <dbl> <dbl> <dbl> <dbl>       <POINT [°]> ##  1  780.     8  17.4 1528. 0.452 (116.912 30.4879) ##  2  395.    48  17.2 1487. 0.842 (116.755 30.5877) ##  3  261.    49  16.0 1456. 3.56  (116.541 30.7548) ##  4  258.    23  17.4 1555. 0.932  (116.241 30.104) ##  5  211.   101  16.3 1494. 3.34   (116.173 30.495) ##  6  386.    10  16.6 1382. 1.65  (116.935 30.9839) ##  7  350.    23  17.5 1569. 0.346 (116.677 30.2412) ##  8  470.    22  17.1 1493. 1.88  (117.066 30.6514) ##  9 1226.    11  17.4 1526. 0.208 (117.171 30.5558) ## 10  137.   598  13.9 1458. 5.92  (116.208 30.8983) ## # ℹ 2,796 more rows fnn(popd_sf, \"popd\", E = 1:15, eps = stats::sd(popd_sf$popd) / 10) ##       E:1       E:2       E:3       E:4       E:5       E:6       E:7       E:8  ## 0.9707769 0.6404134 0.4885959 0.4012830 0.3346401 0.3296507 0.3260870 0.3150392  ##       E:9      E:10      E:11      E:12      E:13      E:14  ## 0.3150392 0.2957947 0.2875980 0.2915182 0.2701354 0.2494654 # temperature and population density g1 = gcmc(popd_sf, \"tem\", \"popd\", E = 10, k = 200, nb = popd_nb, progressbar = FALSE) g1 ##   neighbors tem->popd popd->tem ## 1       200    0.5754   0.08985  # elevation and population density g2 = gcmc(popd_sf, \"elev\", \"popd\", E = 10, k = 200, nb = popd_nb, progressbar = FALSE) g2 ##   neighbors elev->popd popd->elev ## 1       200     0.2675   0.077025  # elevation and temperature g3 = gcmc(popd_sf, \"elev\", \"tem\", E = 10, k = 200, nb = popd_nb, progressbar = FALSE) g3 ##   neighbors elev->tem tem->elev ## 1       200  0.224925    0.4775 .process_xmap_result = \\(g){   tempdf = g$xmap   tempdf$x = g$varname[1]   tempdf$y = g$varname[2]   tempdf = dplyr::select(tempdf, 1, x, y,                          x_xmap_y_mean,x_xmap_y_sig,                          y_xmap_x_mean,y_xmap_x_sig,                          dplyr::everything())    g1 = tempdf |>     dplyr::select(x,y,y_xmap_x_mean,y_xmap_x_sig)|>     purrr::set_names(c(\"cause\",\"effect\",\"cs\",\"sig\"))   g2 = tempdf |>     dplyr::select(y,x,x_xmap_y_mean,x_xmap_y_sig) |>     purrr::set_names(c(\"cause\",\"effect\",\"cs\",\"sig\"))    return(rbind(g1,g2)) }  plot_cs_matrix = \\(.tbf,legend_title = \"Causal Strength\"){   .tbf = .tbf |>     dplyr::mutate(sig_marker = dplyr::case_when(         sig > 0.05 ~ sprintf(\"paste(%.4f^'#')\", cs),               TRUE ~ sprintf('%.4f', cs)     ))    fig = ggplot2::ggplot(data = .tbf,                         ggplot2::aes(x = effect, y = cause)) +     ggplot2::geom_tile(color = \"black\", ggplot2::aes(fill = cs)) +     ggplot2::geom_abline(slope = 1, intercept = 0,                          color = \"black\", linewidth = 0.25) +     ggplot2::geom_text(ggplot2::aes(label = sig_marker), parse = TRUE,                        color = \"black\", family = \"serif\") +     ggplot2::labs(x = \"Effect\", y = \"Cause\", fill = legend_title) +     ggplot2::scale_x_discrete(expand = c(0, 0)) +     ggplot2::scale_y_discrete(expand = c(0, 0)) +     ggplot2::scale_fill_gradient(low = \"#9bbbb8\", high = \"#256c68\") +     ggplot2::coord_equal() +     ggplot2::theme_void() +     ggplot2::theme(       axis.text.x = ggplot2::element_text(angle = 0, family = \"serif\"),       axis.text.y = ggplot2::element_text(color = \"black\", family = \"serif\"),       axis.title.y = ggplot2::element_text(angle = 90, family = \"serif\"),       axis.title.x = ggplot2::element_text(color = \"black\", family = \"serif\",                                            margin = ggplot2::margin(t = 5.5, unit = \"pt\")),       legend.text = ggplot2::element_text(family = \"serif\"),       legend.title = ggplot2::element_text(family = \"serif\"),       legend.background = ggplot2::element_rect(fill = NA, color = NA),       legend.direction = \"horizontal\",       legend.position = \"bottom\",       legend.margin = ggplot2::margin(t = 1, r = 0, b = 0, l = 0, unit = \"pt\"),       legend.key.width = ggplot2::unit(20, \"pt\"),       panel.grid = ggplot2::element_blank(),       panel.border = ggplot2::element_rect(color = \"black\", fill = NA)     )   return(fig) } res1 = list(g1,g2,g3) |>   purrr::map(.process_xmap_result) |>   purrr::list_rbind() res1 ##   cause effect       cs           sig ## 1   tem   popd 0.575400  1.861243e-02 ## 2  popd    tem 0.089850 5.082649e-115 ## 3  elev   popd 0.267500  9.449794e-16 ## 4  popd   elev 0.077025 2.308728e-147 ## 5  elev    tem 0.224925  1.985034e-23 ## 6   tem   elev 0.477500  4.965603e-01 plot_cs_matrix(res1)"},{"path":"https://stscl.github.io/spEDM/articles/GCMC.html","id":"an-example-of-spatial-grid-data","dir":"Articles","previous_headings":"Usage examples","what":"An example of spatial grid data","title":"Geographical Cross Mapping Cardinality","text":"Load spEDM package farmland NPP data: Determining optimal embedding dimension: \\(E = 18\\), false nearest neighbor ratio stabilizes 0.10 remains constant thereafter. Therefore, \\(E = 18\\) selected subsequent GCMC analysis. Organize results long table: Visualize result:","code":"library(spEDM)  npp = terra::rast(system.file(\"case/npp.tif\", package = \"spEDM\")) # To save the computation time, we will aggregate the data by 3 times npp = terra::aggregate(npp, fact = 3, na.rm = TRUE) npp ## class       : SpatRaster  ## size        : 135, 161, 5  (nrow, ncol, nlyr) ## resolution  : 30000, 30000  (x, y) ## extent      : -2625763, 2204237, 1867078, 5917078  (xmin, xmax, ymin, ymax) ## coord. ref. : CGCS2000_Albers  ## source(s)   : memory ## names       :      npp,        pre,      tem,      elev,         hfp  ## min values  :   187.50,   390.3351, -47.8194, -110.1494,  0.04434316  ## max values  : 15381.89, 23734.5330, 262.8576, 5217.6431, 42.68803711  # Inspect NA values terra::global(npp,\"isNA\") ##       isNA ## npp  14815 ## pre  14766 ## tem  14766 ## elev 14760 ## hfp  14972 terra::ncell(npp) ## [1] 21735 nnamat = terra::as.matrix(npp[[1]], wide = TRUE) nnaindice = which(!is.na(nnamat), arr.ind = TRUE) dim(nnaindice) ## [1] 6920    2  # Select 1500 non-NA pixels to predict: set.seed(2025) indices = sample(nrow(nnaindice), size = 1500, replace = FALSE) libindice = nnaindice[-indices,] predindice = nnaindice[indices,] fnn(npp, \"npp\", E = 1:25, lib = predindice, pred = predindice,     eps = stats::sd(terra::values(npp[[\"npp\"]]),na.rm = TRUE) / 10) ##        E:1        E:2        E:3        E:4        E:5        E:6        E:7  ## 0.94062708 0.43266667 0.29533333 0.28200000 0.24133333 0.23066667 0.23066667  ##        E:8        E:9       E:10       E:11       E:12       E:13       E:14  ## 0.19733333 0.19533333 0.15333333 0.15933333 0.16333333 0.14600000 0.13000000  ##       E:15       E:16       E:17       E:18       E:19       E:20       E:21  ## 0.13400000 0.10733333 0.11466667 0.10933333 0.09000000 0.09933333 0.08600000  ##       E:22       E:23       E:24  ## 0.09866667 0.10466667 0.10866667 # precipitation and npp g1 = gcmc(npp, \"pre\", \"npp\", E = 18, k = 165, lib = predindice, pred = predindice, progressbar = FALSE) g1 ##   neighbors  pre->npp  npp->pre ## 1       165 0.2397429 0.2060239  # temperature and npp g2 = gcmc(npp, \"tem\", \"npp\", E = 18, k = 165, lib = predindice, pred = predindice, progressbar = FALSE) g2 ##   neighbors  tem->npp npp->tem ## 1       165 0.4287971 0.432213  # precipitation and temperature g3 = gcmc(npp, \"pre\", \"tem\", E = 18, k = 165, lib = predindice, pred = predindice, progressbar = FALSE) g3 ##   neighbors  pre->tem  tem->pre ## 1       165 0.3222039 0.2725069 res2 = list(g1,g2,g3) |>   purrr::map(.process_xmap_result) |>   purrr::list_rbind() res2 ##   cause effect        cs          sig ## 1   pre    npp 0.2397429 1.571807e-17 ## 2   npp    pre 0.2060239 6.525044e-25 ## 3   tem    npp 0.4287971 4.706879e-02 ## 4   npp    tem 0.4322130 5.956946e-02 ## 5   pre    tem 0.3222039 1.261609e-07 ## 6   tem    pre 0.2725069 5.041517e-13 plot_cs_matrix(res2)"},{"path":"https://stscl.github.io/spEDM/articles/PkgIntro.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Introduction to the spEDM package","text":"spEDM package open-source, computationally efficient toolkit designed provide unified API Spatial Empirical Dynamic Modeling. supports suite prediction-based causal discovery algorithms, including spatial (granger) causality test, geographically convergent cross mapping, geographical cross mapping cardinality. support learning practical application, spEDM offers four carefully curated spatial cross-sectional datasets, paired detailed example showcasing use key algorithms package.","code":""},{"path":"https://stscl.github.io/spEDM/articles/PkgIntro.html","id":"installation","dir":"Articles","previous_headings":"","what":"Installation","title":"Introduction to the spEDM package","text":"Install stable version CRAN : Alternatively, can install development version R-universe :","code":"install.packages(\"spEDM\", dep = TRUE) install.packages(\"spEDM\",                  repos = c(\"https://stscl.r-universe.dev\",                            \"https://cloud.r-project.org\"),                  dep = TRUE)"},{"path":"https://stscl.github.io/spEDM/articles/PkgIntro.html","id":"data","dir":"Articles","previous_headings":"","what":"Data","title":"Introduction to the spEDM package","text":"spEDM package includes four illustrative datasets well-known causation demonstrate key functionalities: Columbus, OH dataset — classic spatial dataset widely used spatial econometrics, included benchmarking demonstration purposes. Data files: columbus.gpkg Population density potential drivers mainland China — county-level dataset capturing population density alongside relevant socio-environmental drivers. Data files: popd.csv, popd_nb.gal Soil copper (Cu) contamination — raster-based dataset representing soil Cu concentrations, associated layers nighttime light intensity industrial density, useful exploring influence human activities environmental pollution. Data files: cu.tif Farmland NPP related variables — raster dataset capturing net primary productivity (NPP) farmland, key climatic variables, elevation, human activity footprints across mainland China, suitable analyzing interactions agricultural productivity, environmental conditions, human activities. Data files: npp.tif datasets can loaded shown :","code":""},{"path":"https://stscl.github.io/spEDM/articles/PkgIntro.html","id":"columbus-oh-spatial-analysis-dataset","dir":"Articles","previous_headings":"Data","what":"Columbus OH spatial analysis dataset","title":"Introduction to the spEDM package","text":"","code":"library(spEDM)  columbus = sf::read_sf(system.file(\"case/columbus.gpkg\", package=\"spEDM\")) columbus ## Simple feature collection with 49 features and 6 fields ## Geometry type: POLYGON ## Dimension:     XY ## Bounding box:  xmin: 5.874907 ymin: 10.78863 xmax: 11.28742 ymax: 14.74245 ## Projected CRS: Undefined Cartesian SRS with unknown unit ## # A tibble: 49 × 7 ##    hoval   inc  crime  open plumb discbd                                     geom ##    <dbl> <dbl>  <dbl> <dbl> <dbl>  <dbl>                                <POLYGON> ##  1  80.5 19.5  15.7   2.85  0.217   5.03 ((8.624129 14.23698, 8.5597 14.74245, 8… ##  2  44.6 21.2  18.8   5.30  0.321   4.27 ((8.25279 14.23694, 8.282758 14.22994, … ##  3  26.4 16.0  30.6   4.53  0.374   3.89 ((8.653305 14.00809, 8.81814 14.00205, … ##  4  33.2  4.48 32.4   0.394 1.19    3.7  ((8.459499 13.82035, 8.473408 13.83227,… ##  5  23.2 11.3  50.7   0.406 0.625   2.83 ((8.685274 13.63952, 8.677577 13.72221,… ##  6  28.8 16.0  26.1   0.563 0.254   3.78 ((9.401384 13.5504, 9.434411 13.69427, … ##  7  75    8.44  0.178 0     2.40    2.74 ((8.037741 13.60752, 8.062716 13.60452,… ##  8  37.1 11.3  38.4   3.48  2.74    2.89 ((8.247527 13.58651, 8.2795 13.5965, 8.… ##  9  52.6 17.6  30.5   0.527 0.891   3.17 ((9.333297 13.27242, 9.671007 13.27361,… ## 10  96.4 13.6  34.0   1.55  0.558   4.33 ((10.08251 13.03377, 10.0925 13.05275, … ## # ℹ 39 more rows"},{"path":"https://stscl.github.io/spEDM/articles/PkgIntro.html","id":"county-level-population-density-in-mainland-china","dir":"Articles","previous_headings":"Data","what":"County-level population density in mainland China","title":"Introduction to the spEDM package","text":"","code":"library(spEDM)  popd_nb = spdep::read.gal(system.file(\"case/popd_nb.gal\",package = \"spEDM\")) ## Warning in spdep::read.gal(system.file(\"case/popd_nb.gal\", package = \"spEDM\")): ## neighbour object has 4 sub-graphs popd_nb ## Neighbour list object: ## Number of regions: 2806  ## Number of nonzero links: 15942  ## Percentage nonzero weights: 0.2024732  ## Average number of links: 5.681397  ## 4 disjoint connected subgraphs  popd = readr::read_csv(system.file(\"case/popd.csv\",package = \"spEDM\")) ## Rows: 2806 Columns: 7 ## ── Column specification ───────────────────────────────────────────────────────── ## Delimiter: \",\" ## dbl (7): lon, lat, popd, elev, tem, pre, slope ##  ## ℹ Use `spec()` to retrieve the full column specification for this data. ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message. popd ## # A tibble: 2,806 × 7 ##      lon   lat  popd  elev   tem   pre slope ##    <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> ##  1  117.  30.5  780.     8  17.4 1528. 0.452 ##  2  117.  30.6  395.    48  17.2 1487. 0.842 ##  3  117.  30.8  261.    49  16.0 1456. 3.56  ##  4  116.  30.1  258.    23  17.4 1555. 0.932 ##  5  116.  30.5  211.   101  16.3 1494. 3.34  ##  6  117.  31.0  386.    10  16.6 1382. 1.65  ##  7  117.  30.2  350.    23  17.5 1569. 0.346 ##  8  117.  30.7  470.    22  17.1 1493. 1.88  ##  9  117.  30.6 1226.    11  17.4 1526. 0.208 ## 10  116.  30.9  137.   598  13.9 1458. 5.92  ## # ℹ 2,796 more rows  popd_sf = sf::st_as_sf(popd, coords = c(\"lon\",\"lat\"), crs = 4326) popd_sf ## Simple feature collection with 2806 features and 5 fields ## Geometry type: POINT ## Dimension:     XY ## Bounding box:  xmin: 74.9055 ymin: 18.2698 xmax: 134.269 ymax: 52.9346 ## Geodetic CRS:  WGS 84 ## # A tibble: 2,806 × 6 ##     popd  elev   tem   pre slope          geometry ##  * <dbl> <dbl> <dbl> <dbl> <dbl>       <POINT [°]> ##  1  780.     8  17.4 1528. 0.452 (116.912 30.4879) ##  2  395.    48  17.2 1487. 0.842 (116.755 30.5877) ##  3  261.    49  16.0 1456. 3.56  (116.541 30.7548) ##  4  258.    23  17.4 1555. 0.932  (116.241 30.104) ##  5  211.   101  16.3 1494. 3.34   (116.173 30.495) ##  6  386.    10  16.6 1382. 1.65  (116.935 30.9839) ##  7  350.    23  17.5 1569. 0.346 (116.677 30.2412) ##  8  470.    22  17.1 1493. 1.88  (117.066 30.6514) ##  9 1226.    11  17.4 1526. 0.208 (117.171 30.5558) ## 10  137.   598  13.9 1458. 5.92  (116.208 30.8983) ## # ℹ 2,796 more rows"},{"path":"https://stscl.github.io/spEDM/articles/PkgIntro.html","id":"soil-cu-heavy-metal-contamination","dir":"Articles","previous_headings":"Data","what":"Soil Cu heavy metal contamination","title":"Introduction to the spEDM package","text":"","code":"library(spEDM)  cu = terra::rast(system.file(\"case/cu.tif\", package=\"spEDM\")) cu ## class       : SpatRaster  ## size        : 131, 125, 3  (nrow, ncol, nlyr) ## resolution  : 5000, 5000  (x, y) ## extent      : 360000, 985000, 1555000, 2210000  (xmin, xmax, ymin, ymax) ## coord. ref. : North_American_1983_Albers  ## source      : cu.tif  ## names       :         cu, industry, ntl  ## min values  :   1.201607,    0.000,   0  ## max values  : 319.599274,    0.615,  63"},{"path":"https://stscl.github.io/spEDM/articles/PkgIntro.html","id":"farmland-npp-and-related-variables-in-mainland-china","dir":"Articles","previous_headings":"Data","what":"Farmland NPP and related variables in mainland China","title":"Introduction to the spEDM package","text":"","code":"library(spEDM) npp = terra::rast(system.file(\"case/npp.tif\", package = \"spEDM\")) npp ## class       : SpatRaster  ## size        : 404, 483, 5  (nrow, ncol, nlyr) ## resolution  : 10000, 10000  (x, y) ## extent      : -2625763, 2204237, 1877078, 5917078  (xmin, xmax, ymin, ymax) ## coord. ref. : CGCS2000_Albers  ## source      : npp.tif  ## names       :      npp,        pre,      tem,      elev,         hfp  ## min values  :   164.00,   384.3409, -47.8194, -122.2004,  0.03390418  ## max values  : 16606.33, 23878.3555, 263.6938, 5350.4902, 44.90312195"},{"path":"https://stscl.github.io/spEDM/articles/PkgIntro.html","id":"usage","dir":"Articles","previous_headings":"","what":"Usage","title":"Introduction to the spEDM package","text":"Users can refer several additional vignettes detailed examples using spEDM, namely: addition spatial extensions provided spEDM, several R packages support Empirical Dynamic Modeling (EDM) time series data: tEDM: R package developed author spEDM, designed implement Temporal Empirical Dynamic Modeling framework. aims maximal consistency spEDM terms API design modeling workflow, facilitating seamless transition spatial temporal EDM applications. rEDM: foundational EDM package implementing simplex projection, S-map, convergent cross mapping (CCM), widely used analyzing nonlinear time series dynamics. multispatialCCM: Implements CCM collections short time series using bootstrapping, enabling causal inference across replicated multi-site time series. fastEDM: high-performance EDM package multi-threaded C++ backend. supports large-scale time series analysis, handles panel data, provides robust options dealing missing values using delay-tolerant algorithms data exclusion.","code":""},{"path":"https://stscl.github.io/spEDM/articles/PkgIntro.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Introduction to the spEDM package","text":"Takens, F. (1981). Detecting strange attractors turbulence. Dynamical Systems Turbulence, Warwick 1980, 366–381. https://doi.org/10.1007/bfb0091924 Mañé, R. (1981). dimension compact invariant sets certain non-linear maps. Dynamical Systems Turbulence, Warwick 1980, 230–242. https://doi.org/10.1007/bfb0091916 Willeboordse, F.H., 2003. spatial logistic map simple prototype spatiotemporal chaos. Chaos: Interdisciplinary Journal Nonlinear Science 13, 533–540. https://doi.org/10.1063/1.1568692 Herrera, M., Mur, J., & Ruiz, M. (2016). Detecting causal relationships spatial processes. Papers Regional Science, 95(3), 577–595. https://doi.org/10.1111/pirs.12144 Gao, B., Yang, J., Chen, Z., Sugihara, G., Li, M., Stein, ., Kwan, M.-P., & Wang, J. (2023). Causal inference cross-sectional earth system data geographical convergent cross mapping. Nature Communications, 14(1). https://doi.org/10.1038/s41467-023-41619-6","code":""},{"path":"https://stscl.github.io/spEDM/articles/SCT.html","id":"methodological-background","dir":"Articles","previous_headings":"","what":"Methodological Background","title":"Spatial Causality Test","text":"Let us begin defining two spatial cross-sectional series \\(\\{x_s\\}_{s \\S}\\) \\(\\{y_s\\}_{s \\S}\\), \\(S\\) represents study area. use: \\[ \\mathcal{X}_W = \\{ W_i x \\mid W_i \\\\mathcal{W}(x, y) \\} \\] \\[ \\mathcal{Y}_W = \\{ W_i y \\mid W_i \\\\mathcal{W}(x, y) \\} \\] denote sets spatial lags \\(x\\) \\(y\\) given weighting matrices \\(\\mathcal{W}(x, y)\\)(set spatial dependence structures \\(x\\) \\(y\\)). say \\(\\{x_s\\}_{s \\S}\\) cause \\(\\{y_s\\}_{s \\S}\\) spatial structures \\(\\mathcal{X}_W\\) \\(\\mathcal{Y}_W\\) \\[ h_{y |\\mathcal{Y}_W}(m) = h_{y | \\mathcal{Y}_W,\\mathcal{X}_W}(m) \\] unilateral non-parametric test can applied assess spatial causality via following null hypothesis: \\[ H_0 : \\{x_s\\}_{s \\S} \\text{ cause } \\{y_s\\}_{s \\S} \\text{ spatial structures } \\mathcal{X}_W \\text{ } \\mathcal{Y}_W, \\] following statistic: \\[ \\hat{\\delta}(\\mathcal{Y}_W, \\mathcal{X}_W) = \\hat{h}_{y |\\mathcal{Y}_W}(m) - \\hat{h}_{y | \\mathcal{Y}_W,\\mathcal{X}_W}(m) \\] \\(\\hat{h}_*(m)\\) estimated conditional symbolic entropy using Shannon’s entropy \\(m-1\\) nearest neighbors. alternative null hypothesis true. \\(\\mathcal{X}_W\\) contain extra information \\(y\\) \\(\\hat{\\delta}(\\mathcal{Y}_W, \\mathcal{X}_W) = 0\\), otherwise, $ (_W, _W) > 0$. \\(h_{y |\\mathcal{Y}_W}(m)\\) measures uncertainty distribution symbols \\(y\\), conditional symbols spatial lag, $ _W$. Moreover, \\(h_{y | \\mathcal{Y}_W,\\mathcal{X}_W}(m)\\) measures uncertainty distribution symbols \\(y\\), conditional symbols spatial lags \\(y\\), \\(\\mathcal{Y}_W\\), \\(x\\), $ _W$. second variable, \\(x\\), indeed causes first one significant decrease entropy, statistic \\(\\hat{\\delta}(\\mathcal{Y}_W, \\mathcal{X}_W)\\) take high positive values. spatial correlation, causation, difference entropies small. statistical significance \\(\\hat{\\delta}(\\mathcal{Y}_W, \\mathcal{X}_W)\\) assessed using spatial block bootstrap.","code":""},{"path":[]},{"path":"https://stscl.github.io/spEDM/articles/SCT.html","id":"an-example-of-spatial-lattice-data","dir":"Articles","previous_headings":"Usage examples","what":"An example of spatial lattice data","title":"Spatial Causality Test","text":"Load spEDM package columbus OH dataset: Detect spatial causality among variables inc, crime, hoval :","code":"library(spEDM)  columbus = sf::read_sf(system.file(\"case/columbus.gpkg\", package=\"spEDM\")) columbus ## Simple feature collection with 49 features and 6 fields ## Geometry type: POLYGON ## Dimension:     XY ## Bounding box:  xmin: 5.874907 ymin: 10.78863 xmax: 11.28742 ymax: 14.74245 ## Projected CRS: Undefined Cartesian SRS with unknown unit ## # A tibble: 49 × 7 ##    hoval   inc  crime  open plumb discbd                                    geom ##    <dbl> <dbl>  <dbl> <dbl> <dbl>  <dbl>                               <POLYGON> ##  1  80.5 19.5  15.7   2.85  0.217   5.03 ((8.624129 14.23698, 8.5597 14.74245, … ##  2  44.6 21.2  18.8   5.30  0.321   4.27 ((8.25279 14.23694, 8.282758 14.22994,… ##  3  26.4 16.0  30.6   4.53  0.374   3.89 ((8.653305 14.00809, 8.81814 14.00205,… ##  4  33.2  4.48 32.4   0.394 1.19    3.7  ((8.459499 13.82035, 8.473408 13.83227… ##  5  23.2 11.3  50.7   0.406 0.625   2.83 ((8.685274 13.63952, 8.677577 13.72221… ##  6  28.8 16.0  26.1   0.563 0.254   3.78 ((9.401384 13.5504, 9.434411 13.69427,… ##  7  75    8.44  0.178 0     2.40    2.74 ((8.037741 13.60752, 8.062716 13.60452… ##  8  37.1 11.3  38.4   3.48  2.74    2.89 ((8.247527 13.58651, 8.2795 13.5965, 8… ##  9  52.6 17.6  30.5   0.527 0.891   3.17 ((9.333297 13.27242, 9.671007 13.27361… ## 10  96.4 13.6  34.0   1.55  0.558   4.33 ((10.08251 13.03377, 10.0925 13.05275,… ## # ℹ 39 more rows # house value and crime sc.test(columbus, \"hoval\", \"crime\", k = 15) ## spatial causality test ## hoval -> crime: statistic = 1.114, p value = 0.574 ## crime -> hoval: statistic = 1.555, p value = 0  # household income and crime sc.test(columbus, \"inc\", \"crime\", k = 15) ## spatial causality test ## inc -> crime: statistic = 0.739, p value = 0.975 ## crime -> inc: statistic = 0.946, p value = 0.762  # household income and house value sc.test(columbus, \"inc\", \"hoval\", k = 15) ## spatial causality test ## inc -> hoval: statistic = 1.211, p value = 0.311 ## hoval -> inc: statistic = 0.992, p value = 0.712"},{"path":"https://stscl.github.io/spEDM/articles/SCT.html","id":"an-example-of-spatial-grid-data","dir":"Articles","previous_headings":"Usage examples","what":"An example of spatial grid data","title":"Spatial Causality Test","text":"Load spEDM package farmland NPP data: Detect spatial causality among variables pre, tem, npp :","code":"library(spEDM)  npp = terra::rast(system.file(\"case/npp.tif\", package = \"spEDM\")) # To save the computation time, we will aggregate the data by 3 times npp = terra::aggregate(npp, fact = 3, na.rm = TRUE) npp ## class       : SpatRaster  ## size        : 135, 161, 5  (nrow, ncol, nlyr) ## resolution  : 30000, 30000  (x, y) ## extent      : -2625763, 2204237, 1867078, 5917078  (xmin, xmax, ymin, ymax) ## coord. ref. : CGCS2000_Albers  ## source(s)   : memory ## names       :      npp,        pre,      tem,      elev,         hfp  ## min values  :   187.50,   390.3351, -47.8194, -110.1494,  0.04434316  ## max values  : 15381.89, 23734.5330, 262.8576, 5217.6431, 42.68803711 # precipitation and npp sc.test(npp,\"pre\",\"npp\",k = 30) ## spatial causality test ## pre -> npp: statistic = 0.227, p value = 0 ## npp -> pre: statistic = 0.16, p value = 0  # temperature and npp sc.test(npp,\"tem\",\"npp\",k = 30) ## spatial causality test ## tem -> npp: statistic = 0.168, p value = 0 ## npp -> tem: statistic = 0.169, p value = 0  # precipitation and temperature sc.test(npp,\"pre\",\"tem\",k = 30) ## spatial causality test ## pre -> tem: statistic = 0.19, p value = 0 ## tem -> pre: statistic = 0.147, p value = 0"},{"path":"https://stscl.github.io/spEDM/articles/SLM.html","id":"methodological-background","dir":"Articles","previous_headings":"","what":"Methodological Background","title":"Spatial Logistic Map","text":"logistic map one fundamental nonlinear dynamical systems used explore transition regularity chaos. univariate temporal form, logistic map expressed : \\[ x_{t+1} = r x_t (1 - x_t), \\] \\(x_t \\[0,1]\\) state system time \\(t\\), \\(r\\) growth parameter. Despite algebraic simplicity, logistic map exhibits rich spectrum dynamical behaviors, including bifurcations, periodic orbits, deterministic chaos, depending value \\(r\\). sensitivity initial conditions nonlinear feedback makes canonical model exploring complex temporal dynamics. multivariate extensions logistic map, coupled logistic systems, variable evolves logistic rule also influenced states variables. common form : \\[ x_{t+1}^{()} = r_i x_t^{()} \\left(1 - x_t^{()} - \\sum_{j \\neq } \\beta_{ij} x_t^{(j)} \\right), \\] \\(\\beta_{ij}\\) denotes inhibitory (facilitative) effect variable \\(j\\) variable \\(\\). multivariate systems allow study interaction-driven complexity, including predator-prey dynamics, interspecies competition, coevolutionary processes. framework can extended spatial domains account interactions among neighboring spatial units. resulting system, known Spatial Logistic Map (SLM), distributes logistic dynamics spatial lattice. simplest case, location \\(\\) lattice updates according : \\[ x_{}^{(t+1)} = 1 - \\alpha x_i^{(t)} \\cdot \\frac{1}{k} \\sum_{j \\\\mathcal{N}()} x_j^{(t)}, \\] \\(\\alpha\\) controls strength nonlinearity spatial coupling, \\(\\mathcal{N}()\\) denotes set spatial neighbors (e.g., rook- queen-connected units), \\(k = |\\mathcal{N}()|\\) number neighbors. form reflects local averaging interaction: future value unit depends current value average state neighbors. Importantly, extended multivariate spatial settings, bivariate trivariate spatial logistic maps, spatial variable evolves neighbors also inter-variable interactions. example, bivariate spatial logistic map, update rules may written : Local cross-variable interaction (default form): \\[ x_{}^{(t+1)} = 1 - \\alpha_1 x_i^{(t)} \\left( \\frac{1}{k} \\sum_{j \\\\mathcal{N}()} x_j^{(t)} - \\beta_{21} y_i^{(t)} \\right), \\\\ y_{}^{(t+1)} = 1 - \\alpha_2 y_i^{(t)} \\left( \\frac{1}{k} \\sum_{j \\\\mathcal{N}()} y_j^{(t)} - \\beta_{12} x_i^{(t)} \\right). \\] , inhibitory (facilitative) influence variables restricted spatial location. Neighbor-averaged cross-variable interaction (extended form): \\[ x_{}^{(t+1)} = 1 - \\alpha_1 x_i^{(t)} \\left( \\frac{1}{k} \\sum_{j \\\\mathcal{N}()} x_j^{(t)} - \\beta_{21} \\frac{1}{k} \\sum_{j \\\\mathcal{N}()} y_j^{(t)} \\right), \\\\ y_{}^{(t+1)} = 1 - \\alpha_2 y_i^{(t)} \\left( \\frac{1}{k} \\sum_{j \\\\mathcal{N}()} y_j^{(t)} - \\beta_{12} \\frac{1}{k} \\sum_{j \\\\mathcal{N}()} x_j^{(t)} \\right). \\] alternative form, inter-variable interactions mediated neighbor-averaged states, allowing variable influenced spatial context . formulations capture combination local spatial coupling cross-variable inhibition, differ whether cross-variable effects purely local spatially contextualized. distinctions lead different spatiotemporal outcomes, including waves, kinks, frozen random states, spatiotemporal chaos. performing statistical aggregation long-run time series values spatial unit, one can generate spatial cross-sectional data reflect different causal scenarios.","code":""},{"path":"https://stscl.github.io/spEDM/articles/SLM.html","id":"usage-examples","dir":"Articles","previous_headings":"","what":"Usage examples","title":"Spatial Logistic Map","text":"first construct three simulated species density distributions combining Gaussian random field multivariate normal distribution. assume underlying causal interaction structure among species, species influences b, b turn influences c (.e., → b → c). intrinsic growth rates species , b, c uniformly assigned value 0.2. Species exerts effect 1 species b, species b exerts effect 1 species c. interspecific influence parameters set 0. setup provides controlled environment test spatial causality detection methods known dynamic interactions.","code":"sim_trispecies = \\(nx,ny,seed = 123){   grid = expand.grid(seq(0, 10, length.out = nx),                      seq(0, 10, length.out = ny))   cov.fun = \\(d, range = 1.5, sill=1) sill * exp(-d/range)   dist.mat = fields::rdist(grid)   cov.mat = cov.fun(dist.mat, range=1.5, sill=1)   set.seed(seed)   res = replicate(3, {     MASS::mvrnorm(1, rep(0, nrow(grid)), cov.mat) |>       pmax(0) |>       sdsfun::normalize_vector(0,1) |>       matrix(nrow = nx, ncol = ny) |>       terra::rast()   }, simplify = FALSE)   terra::rast(res) }  species = sim_trispecies(20,20) names(species) = letters[1:3] species ## class       : SpatRaster  ## size        : 20, 20, 3  (nrow, ncol, nlyr) ## resolution  : 1, 1  (x, y) ## extent      : 0, 20, 0, 20  (xmin, xmax, ymin, ymax) ## coord. ref. :   ## source(s)   : memory ## names       : a, b, c  ## min values  : 0, 0, 0  ## max values  : 1, 1, 1  options(terra.pal = grDevices::terrain.colors(100,rev = T)) terra::plot(species, nc = 3,             mar = rep(0.1,4),             oma = rep(0.1,4),             axes = FALSE,             legend = FALSE) simv = spEDM::slm(species, x = \"a\", y = \"b\", z = \"c\", k = 4, step = 15, transient = 1, interact = \"local\",                   alpha_x = 0.2, alpha_y = 0.2, alpha_z = 0.2,                   beta_xy = 1, beta_xz = 0, beta_yx = 0, beta_yz = 1, beta_zx = 0, beta_zy = 0)  species_evolution = species terra::values(species_evolution[[\"a\"]]) = simv$x terra::values(species_evolution[[\"b\"]]) = simv$y terra::values(species_evolution[[\"c\"]]) = simv$z species_evolution ## class       : SpatRaster  ## size        : 20, 20, 3  (nrow, ncol, nlyr) ## resolution  : 1, 1  (x, y) ## extent      : 0, 20, 0, 20  (xmin, xmax, ymin, ymax) ## coord. ref. :   ## source(s)   : memory ## names       :         a,         b,         c  ## min values  : 0.8553408, 0.9733337, 0.9886246  ## max values  : 0.8611597, 0.9803933, 1.0008822  terra::plot(species_evolution, nc = 3,             mar = rep(0.1,4),             oma = rep(0.1,4),             axes = FALSE,             legend = FALSE) simv = spEDM::slm(species, x = \"a\", y = \"b\", z = \"c\", k = 4, step = 15, transient = 1, interact = \"neighbors\",                   alpha_x = 0.2, alpha_y = 0.2, alpha_z = 0.2, beta_xy = 1, beta_xz = 0, beta_yx = 0, beta_yz = 1, beta_zx = 0, beta_zy = 0)  species_evolution = species terra::values(species_evolution[[\"a\"]]) = simv$x terra::values(species_evolution[[\"b\"]]) = simv$y terra::values(species_evolution[[\"c\"]]) = simv$z species_evolution ## class       : SpatRaster  ## size        : 20, 20, 3  (nrow, ncol, nlyr) ## resolution  : 1, 1  (x, y) ## extent      : 0, 20, 0, 20  (xmin, xmax, ymin, ymax) ## coord. ref. :   ## source(s)   : memory ## names       :         a,         b,         c  ## min values  : 0.8553408, 0.9718102, 0.9887262  ## max values  : 0.8611597, 0.9803232, 0.9986816  terra::plot(species_evolution, nc = 3,             mar = rep(0.1,4),             oma = rep(0.1,4),             axes = FALSE,             legend = FALSE)"},{"path":"https://stscl.github.io/spEDM/articles/SSR.html","id":"methodological-background","dir":"Articles","previous_headings":"","what":"Methodological Background","title":"State Space Reconstruction","text":"Takens theory proves dynamical system \\(\\phi\\), trajectory converges attractor manifold \\(M\\)—bounded invariant set states—exists smooth mapping system \\(\\phi\\) attractor \\(M\\). Consequently, time series observations \\(\\phi\\) can used reconstruct structure \\(M\\) delay embedding. According generalized embedding theorem, compact \\(d\\)-dimensional manifold \\(M\\) set observation functions \\(\\langle h_1, h_2, \\ldots, h_L \\rangle\\), mapping \\(\\psi_{\\phi,h}(x) = \\langle h_1(x), h_2(x), \\ldots, h_L(x) \\rangle\\) embedding \\(M\\) \\(L \\geq 2d + 1\\). , embedding refers one--one map resolves singularities original manifold. observation functions \\(h_i\\) can take form time-lagged values single time series, lags multiple time series, even completely distinct measurements. former two simply special cases third. embedding framework can extended spatial cross-sectional data, lack temporal ordering observed spatial domain. context, observation functions can defined using values variable focal spatial unit surrounding neighbors (known spatial lags spatial statistics). Specifically, spatial location \\(s\\), embedding can written : \\[ \\psi(x, s) = \\langle h_s(x), h_{s(1)}(x), \\ldots, h_{s(L-1)}(x) \\rangle, \\] \\(h_{s()}(x)\\) denotes observation function \\(\\)-th order spatial lag unit relative \\(s\\). spatial lags provide necessary diversity observations effective manifold reconstruction. practice, given spatial lag order involves multiple units, summary statistics mean directionally-weighted averages can used observation function maintain one--one embedding.","code":""},{"path":[]},{"path":"https://stscl.github.io/spEDM/articles/SSR.html","id":"an-example-of-spatial-lattice-data","dir":"Articles","previous_headings":"Usage examples","what":"An example of spatial lattice data","title":"State Space Reconstruction","text":"Load spEDM package county-level population density data: Embedding variable popd county-level population density:","code":"library(spEDM)  popd_nb = spdep::read.gal(system.file(\"case/popd_nb.gal\",package = \"spEDM\")) ## Warning in spdep::read.gal(system.file(\"case/popd_nb.gal\", package = \"spEDM\")): neighbour ## object has 4 sub-graphs popd = readr::read_csv(system.file(\"case/popd.csv\",package = \"spEDM\")) ## Rows: 2806 Columns: 7 ## ── Column specification ─────────────────────────────────────────────────────────────────────── ## Delimiter: \",\" ## dbl (7): lon, lat, popd, elev, tem, pre, slope ##  ## ℹ Use `spec()` to retrieve the full column specification for this data. ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message. popd_sf = sf::st_as_sf(popd, coords = c(\"lon\",\"lat\"), crs = 4326) popd_sf ## Simple feature collection with 2806 features and 5 fields ## Geometry type: POINT ## Dimension:     XY ## Bounding box:  xmin: 74.9055 ymin: 18.2698 xmax: 134.269 ymax: 52.9346 ## Geodetic CRS:  WGS 84 ## # A tibble: 2,806 × 6 ##     popd  elev   tem   pre slope          geometry ##  * <dbl> <dbl> <dbl> <dbl> <dbl>       <POINT [°]> ##  1  780.     8  17.4 1528. 0.452 (116.912 30.4879) ##  2  395.    48  17.2 1487. 0.842 (116.755 30.5877) ##  3  261.    49  16.0 1456. 3.56  (116.541 30.7548) ##  4  258.    23  17.4 1555. 0.932  (116.241 30.104) ##  5  211.   101  16.3 1494. 3.34   (116.173 30.495) ##  6  386.    10  16.6 1382. 1.65  (116.935 30.9839) ##  7  350.    23  17.5 1569. 0.346 (116.677 30.2412) ##  8  470.    22  17.1 1493. 1.88  (117.066 30.6514) ##  9 1226.    11  17.4 1526. 0.208 (117.171 30.5558) ## 10  137.   598  13.9 1458. 5.92  (116.208 30.8983) ## # ℹ 2,796 more rows v = spEDM::embedded(popd_sf,\"popd\",E = 10) v[1:5,c(4,5,10)] ##           [,1]     [,2]      [,3] ## [1,]  962.7204 1664.756 1581.4351 ## [2,]  919.6000 2408.766 1494.8241 ## [3,] 1435.0165 1958.686  813.9077 ## [4,] 1488.2727 2066.748 1216.6986 ## [5,] 2326.8429 1290.188 1038.3864 plot3D::scatter3D(v[,4], v[,5], v[,10], colvar = NULL, pch = 19,                   col = \"red\", theta = 45, phi = 10, cex = 0.35,                   bty = \"f\", clab = NA, tickmarks = FALSE)"},{"path":"https://stscl.github.io/spEDM/articles/SSR.html","id":"an-example-of-spatial-grid-data","dir":"Articles","previous_headings":"Usage examples","what":"An example of spatial grid data","title":"State Space Reconstruction","text":"Load spEDM package farmland npp data: Embedding variable npp farmland npp data:","code":"library(spEDM)  npp = terra::rast(system.file(\"case/npp.tif\", package = \"spEDM\")) npp ## class       : SpatRaster  ## size        : 404, 483, 5  (nrow, ncol, nlyr) ## resolution  : 10000, 10000  (x, y) ## extent      : -2625763, 2204237, 1877078, 5917078  (xmin, xmax, ymin, ymax) ## coord. ref. : CGCS2000_Albers  ## source      : npp.tif  ## names       :      npp,        pre,      tem,      elev,         hfp  ## min values  :   164.00,   384.3409, -47.8194, -122.2004,  0.03390418  ## max values  : 16606.33, 23878.3555, 263.6938, 5350.4902, 44.90312195 r = spEDM::embedded(npp,\"npp\",E = 5,tau = 20) r[1.001e4:1.002e4,1:3] ##           [,1]     [,2]     [,3] ##  [1,] 2614.799 3032.174 2631.979 ##  [2,] 2621.955 3049.761 2665.456 ##  [3,] 2648.524 3012.623 2650.998 ##  [4,] 2592.420 3206.427 2652.669 ##  [5,] 2549.374 3266.779 2632.158 ##  [6,] 2574.278 3230.915 2589.830 ##  [7,] 2631.401 3164.674 2573.544 ##  [8,] 2674.011 3152.381 2598.629 ##  [9,] 2546.081 3179.526 2653.730 ## [10,] 2548.110 3143.147 2660.943 ## [11,] 2570.946 3162.219 2696.025 plot3D::scatter3D(r[,1], r[,2], r[,3], colvar = NULL, pch = 19,                   col = \"#e77854\", theta = 45, phi = 10, cex = 0.01,                   bty = \"f\", clab = NA, tickmarks = FALSE)"},{"path":"https://stscl.github.io/spEDM/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Wenbo Lv. Author, maintainer, copyright holder.","code":""},{"path":"https://stscl.github.io/spEDM/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Lv W (2025). spEDM: Spatial Empirical Dynamic Modeling. doi:10.32614/CRAN.package.spEDM, R package version 1.9.","code":"@Manual{,   title = {{spEDM: Spatial Empirical Dynamic Modeling}},   author = {Wenbo Lv},   year = {2025},   note = {R package version 1.9},   doi = {10.32614/CRAN.package.spEDM}, }"},{"path":"https://stscl.github.io/spEDM/index.html","id":"spedm","dir":"","previous_headings":"","what":"spEDM | Spatial Empirical Dynamic Modeling\n","title":"spEDM | Spatial Empirical Dynamic Modeling\n","text":"Spatial Empirical Dynamic Modeling spEDM R package spatial causal discovery. extends Empirical Dynamic Modeling (EDM) time series spatial cross-sectional data, supports vector raster spatial formats via integration sf terra, enables data-driven causal inference spatial snapshots. Refer package documentation https://stscl.github.io/spEDM/ detailed information.","code":""},{"path":"https://stscl.github.io/spEDM/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"spEDM | Spatial Empirical Dynamic Modeling\n","text":"Install CRAN : Install binary version R-universe : Install source code GitHub :","code":"install.packages(\"spEDM\", dep = TRUE) install.packages(\"spEDM\",                  repos = c(\"https://stscl.r-universe.dev\",                            \"https://cloud.r-project.org\"),                  dep = TRUE) if (!requireNamespace(\"devtools\")) {     install.packages(\"devtools\") } devtools::install_github(\"stscl/spEDM\",                          build_vignettes = TRUE,                          dep = TRUE)"},{"path":"https://stscl.github.io/spEDM/reference/detectThreads.html","id":null,"dir":"Reference","previous_headings":"","what":"detect the number of available threads — detectThreads","title":"detect the number of available threads — detectThreads","text":"detect number available threads","code":""},{"path":"https://stscl.github.io/spEDM/reference/detectThreads.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"detect the number of available threads — detectThreads","text":"","code":"detectThreads()"},{"path":"https://stscl.github.io/spEDM/reference/detectThreads.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"detect the number of available threads — detectThreads","text":"integer","code":""},{"path":"https://stscl.github.io/spEDM/reference/detectThreads.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"detect the number of available threads — detectThreads","text":"","code":"# \\donttest{ detectThreads() #> [1] 4 # }"},{"path":"https://stscl.github.io/spEDM/reference/embedded.html","id":null,"dir":"Reference","previous_headings":"","what":"embedding spatial cross sectional data — embedded","title":"embedding spatial cross sectional data — embedded","text":"embedding spatial cross sectional data","code":""},{"path":"https://stscl.github.io/spEDM/reference/embedded.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"embedding spatial cross sectional data — embedded","text":"","code":"# S4 method for class 'sf' embedded(   data,   target,   E = 3,   tau = 1,   style = 1,   stack = FALSE,   detrend = FALSE,   nb = NULL )  # S4 method for class 'SpatRaster' embedded(   data,   target,   E = 3,   tau = 1,   style = 1,   stack = FALSE,   detrend = FALSE,   grid.coord = TRUE,   embed.direction = 0 )"},{"path":"https://stscl.github.io/spEDM/reference/embedded.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"embedding spatial cross sectional data — embedded","text":"data observation data. target name target variable. E (optional) embedding dimensions. tau (optional) step spatial lags. style (optional) embedding style (0 includes current state, 1 excludes ). stack (optional) whether stack embeddings. detrend (optional) whether remove linear trend. nb (optional) neighbours list. grid.coord (optional) whether detrend using cell center coordinates (TRUE) row/column numbers (FALSE). embed.direction (optional) direction selector embeddings (0 returns directions, 1-8 correspond NW, N, NE, W, E, SW, S, SE).","code":""},{"path":"https://stscl.github.io/spEDM/reference/embedded.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"embedding spatial cross sectional data — embedded","text":"matrix (stack FALSE) list.","code":""},{"path":"https://stscl.github.io/spEDM/reference/embedded.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"embedding spatial cross sectional data — embedded","text":"","code":"columbus = sf::read_sf(system.file(\"case/columbus.gpkg\", package=\"spEDM\")) v = embedded(columbus,\"crime\") v[1:5,] #>          [,1]     [,2]     [,3] #> [1,] 24.71427 41.55964 43.45135 #> [2,] 26.24684 44.57868 40.73529 #> [3,] 29.41175 43.45135 37.55683 #> [4,] 34.64648 37.95647 38.69064 #> [5,] 40.46533 34.43484 42.28334  npp = terra::rast(system.file(\"case/npp.tif\", package=\"spEDM\")) r = embedded(npp,\"npp\") r[which(!is.na(r),arr.ind = TRUE)[1:5],] #>          [,1]     [,2]     [,3] #> [1,] 3467.572 3572.004 2611.333 #> [2,] 3355.386 3361.382      NaN #> [3,] 3107.368 3736.406 3329.188 #> [4,] 2927.267 3519.752 3652.413 #> [5,] 3089.903 3562.450 3664.286"},{"path":"https://stscl.github.io/spEDM/reference/fnn.html","id":null,"dir":"Reference","previous_headings":"","what":"false nearest neighbours — fnn","title":"false nearest neighbours — fnn","text":"false nearest neighbours","code":""},{"path":"https://stscl.github.io/spEDM/reference/fnn.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"false nearest neighbours — fnn","text":"","code":"# S4 method for class 'sf' fnn(   data,   target,   E = 1:10,   tau = 1,   style = 1,   lib = NULL,   pred = NULL,   dist.metric = \"L1\",   rt = 10,   eps = 2,   threads = detectThreads(),   detrend = TRUE,   nb = NULL )  # S4 method for class 'SpatRaster' fnn(   data,   target,   E = 1:10,   tau = 1,   style = 1,   lib = NULL,   pred = NULL,   dist.metric = \"L1\",   rt = 10,   eps = 2,   threads = detectThreads(),   detrend = TRUE,   grid.coord = TRUE )"},{"path":"https://stscl.github.io/spEDM/reference/fnn.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"false nearest neighbours — fnn","text":"data observation data. target name target variable. E (optional) embedding dimensions. tau (optional) step spatial lags. style (optional) embedding style (0 includes current state, 1 excludes ). lib (optional) libraries indices. pred (optional) predictions indices. dist.metric (optional) distance metric (L1: Manhattan, L2: Euclidean). rt (optional) escape factor. eps (optional) neighborhood diameter. threads (optional) number threads use. detrend (optional) whether remove linear trend. nb (optional) neighbours list. grid.coord (optional) whether detrend using cell center coordinates (TRUE) row/column numbers (FALSE).","code":""},{"path":"https://stscl.github.io/spEDM/reference/fnn.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"false nearest neighbours — fnn","text":"vector","code":""},{"path":"https://stscl.github.io/spEDM/reference/fnn.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"false nearest neighbours — fnn","text":"Kennel M. B., Brown R. Abarbanel H. D. ., Determining embedding dimension phase-space reconstruction using geometrical construction, Phys. Rev. , Volume 45, 3403 (1992).","code":""},{"path":"https://stscl.github.io/spEDM/reference/fnn.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"false nearest neighbours — fnn","text":"","code":"columbus = sf::read_sf(system.file(\"case/columbus.gpkg\", package=\"spEDM\")) # \\donttest{ fnn(columbus,\"crime\") #>        E:1        E:2        E:3        E:4        E:5        E:6        E:7  #> 0.79591837 0.53061224 0.63265306 0.51020408 0.12244898 0.04081633 0.00000000  #>        E:8  #> 0.00000000  # }"},{"path":"https://stscl.github.io/spEDM/reference/gccm.html","id":null,"dir":"Reference","previous_headings":"","what":"geographical convergent cross mapping — gccm","title":"geographical convergent cross mapping — gccm","text":"geographical convergent cross mapping","code":""},{"path":"https://stscl.github.io/spEDM/reference/gccm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"geographical convergent cross mapping — gccm","text":"","code":"# S4 method for class 'sf' gccm(   data,   cause,   effect,   libsizes = NULL,   E = 3,   k = E + 2,   tau = 1,   style = 1,   stack = FALSE,   lib = NULL,   pred = NULL,   dist.metric = \"L2\",   dist.average = TRUE,   theta = 1,   algorithm = \"simplex\",   threads = detectThreads(),   detrend = TRUE,   parallel.level = \"low\",   bidirectional = TRUE,   progressbar = TRUE,   nb = NULL )  # S4 method for class 'SpatRaster' gccm(   data,   cause,   effect,   libsizes = NULL,   E = 3,   k = E + 2,   tau = 1,   style = 1,   stack = FALSE,   lib = NULL,   pred = NULL,   dist.metric = \"L2\",   dist.average = TRUE,   theta = 1,   algorithm = \"simplex\",   threads = detectThreads(),   detrend = TRUE,   parallel.level = \"low\",   bidirectional = TRUE,   progressbar = TRUE,   grid.coord = TRUE,   embed.direction = 0,   win.ratio = 0 )"},{"path":"https://stscl.github.io/spEDM/reference/gccm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"geographical convergent cross mapping — gccm","text":"data observation data. cause name causal variable. effect name effect variable. libsizes (optional) number spatial units used (input needed: vector - spatial vector, matrix - spatial raster). E (optional) embedding dimensions. k (optional) number nearest neighbors. tau (optional) step spatial lags. style (optional) embedding style (0 includes current state, 1 excludes ). stack (optional) whether stack embeddings. lib (optional) libraries indices (input requirement libsizes). pred (optional) predictions indices (input requirement libsizes). dist.metric (optional) distance metric (L1: Manhattan, L2: Euclidean). dist.average (optional) whether average distance. theta (optional) weighting parameter distances, useful algorithm smap. algorithm (optional) prediction algorithm. threads (optional) number threads use. detrend (optional) whether remove linear trend. parallel.level (optional) level parallelism, low high. bidirectional (optional) whether examine bidirectional causality. progressbar (optional) whether show progress bar. nb (optional) neighbours list. grid.coord (optional) whether detrend using cell center coordinates (TRUE) row/column numbers (FALSE). embed.direction (optional) direction selector embeddings (0 returns directions, 1-8 correspond NW, N, NE, W, E, SW, S, SE). win.ratio (optional) ratio sliding window scale speed state-space predictions.","code":""},{"path":"https://stscl.github.io/spEDM/reference/gccm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"geographical convergent cross mapping — gccm","text":"list xmap cross mapping results varname names causal effect variable bidirectional whether examine bidirectional causality","code":""},{"path":"https://stscl.github.io/spEDM/reference/gccm.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"geographical convergent cross mapping — gccm","text":"Gao, B., Yang, J., Chen, Z. et al. Causal inference cross-sectional earth system data geographical convergent cross mapping. Nat Commun 14, 5875 (2023).","code":""},{"path":"https://stscl.github.io/spEDM/reference/gccm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"geographical convergent cross mapping — gccm","text":"","code":"columbus = sf::read_sf(system.file(\"case/columbus.gpkg\", package=\"spEDM\")) # \\donttest{ g = gccm(columbus,\"hoval\",\"crime\",libsizes = seq(5,45,5),E = 6) #>  Computing: [========================================] 100% (done)                          #>  Computing: [========================================] 100% (done)                          g #>   libsizes hoval->crime crime->hoval #> 1        5    0.1253050    0.2568469 #> 2       10    0.1762769    0.3961522 #> 3       15    0.2197481    0.4672470 #> 4       20    0.2324435    0.5144297 #> 5       25    0.2354728    0.5713321 #> 6       30    0.2360934    0.6048914 #> 7       35    0.2412944    0.6253026 #> 8       40    0.2383788    0.6364897 #> 9       45    0.2339483    0.6484721 plot(g, ylimits = c(0,0.85))  # }"},{"path":"https://stscl.github.io/spEDM/reference/gcmc.html","id":null,"dir":"Reference","previous_headings":"","what":"geographical cross mapping cardinality — gcmc","title":"geographical cross mapping cardinality — gcmc","text":"geographical cross mapping cardinality","code":""},{"path":"https://stscl.github.io/spEDM/reference/gcmc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"geographical cross mapping cardinality — gcmc","text":"","code":"# S4 method for class 'sf' gcmc(   data,   cause,   effect,   libsizes = NULL,   E = 3,   k = pmin(E^2),   tau = 1,   style = 1,   lib = NULL,   pred = NULL,   dist.metric = \"L2\",   threads = detectThreads(),   detrend = FALSE,   parallel.level = \"low\",   bidirectional = TRUE,   progressbar = TRUE,   nb = NULL )  # S4 method for class 'SpatRaster' gcmc(   data,   cause,   effect,   libsizes = NULL,   E = 3,   k = pmin(E^2),   tau = 1,   style = 1,   lib = NULL,   pred = NULL,   dist.metric = \"L2\",   threads = detectThreads(),   detrend = FALSE,   parallel.level = \"low\",   bidirectional = TRUE,   progressbar = TRUE,   grid.coord = TRUE )"},{"path":"https://stscl.github.io/spEDM/reference/gcmc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"geographical cross mapping cardinality — gcmc","text":"data observation data. cause name causal variable. effect name effect variable. libsizes (optional) number spatial units used (input needed: vector - spatial vector, matrix - spatial raster). E (optional) embedding dimensions. k (optional) number nearest neighbors. tau (optional) step spatial lags. style (optional) embedding style (0 includes current state, 1 excludes ). lib (optional) libraries indices (input requirement libsizes). pred (optional) predictions indices (input requirement libsizes). dist.metric (optional) distance metric (L1: Manhattan, L2: Euclidean). threads (optional) number threads use. detrend (optional) whether remove linear trend. parallel.level (optional) level parallelism, low high. bidirectional (optional) whether examine bidirectional causality. progressbar (optional) whether show progress bar. nb (optional) neighbours list. grid.coord (optional) whether detrend using cell center coordinates (TRUE) row/column numbers (FALSE).","code":""},{"path":"https://stscl.github.io/spEDM/reference/gcmc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"geographical cross mapping cardinality — gcmc","text":"list xmap cross mapping results cs causal strength varname names causal effect variable bidirectional whether examine bidirectional causality","code":""},{"path":"https://stscl.github.io/spEDM/reference/gcmc.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"geographical cross mapping cardinality — gcmc","text":"","code":"columbus = sf::read_sf(system.file(\"case/columbus.gpkg\", package=\"spEDM\")) # \\donttest{ g = gcmc(columbus,\"hoval\",\"crime\",E = 7,k = 18) #>  Computing: [========================================] 100% (done)                          #>  Computing: [========================================] 100% (done)                          g #>   neighbors hoval->crime crime->hoval #> 1        18     0.183642    0.2901235 # }"},{"path":"https://stscl.github.io/spEDM/reference/ic.html","id":null,"dir":"Reference","previous_headings":"","what":"intersection cardinality — ic","title":"intersection cardinality — ic","text":"intersection cardinality","code":""},{"path":"https://stscl.github.io/spEDM/reference/ic.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"intersection cardinality — ic","text":"","code":"# S4 method for class 'sf' ic(   data,   column,   target,   E = 2:10,   k = E + 2,   tau = 1,   style = 1,   lib = NULL,   pred = NULL,   dist.metric = \"L2\",   threads = detectThreads(),   detrend = FALSE,   parallel.level = \"low\",   nb = NULL )  # S4 method for class 'SpatRaster' ic(   data,   column,   target,   E = 2:10,   k = E + 2,   tau = 1,   style = 1,   lib = NULL,   pred = NULL,   dist.metric = \"L2\",   threads = detectThreads(),   detrend = FALSE,   parallel.level = \"low\",   grid.coord = TRUE )"},{"path":"https://stscl.github.io/spEDM/reference/ic.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"intersection cardinality — ic","text":"data observation data. column name library variable. target name target variable. E (optional) embedding dimensions. k (optional) number nearest neighbors used. tau (optional) step spatial lags. style (optional) embedding style (0 includes current state, 1 excludes ). lib (optional) libraries indices (input needed: vector - spatial vector, matrix - spatial raster). pred (optional) predictions indices (input requirement lib). dist.metric (optional) distance metric (L1: Manhattan, L2: Euclidean). threads (optional) number threads use. detrend (optional) whether remove linear trend. parallel.level (optional) level parallelism, low high. nb (optional) neighbours list. grid.coord (optional) whether detrend using cell center coordinates (TRUE) row/column numbers (FALSE).","code":""},{"path":"https://stscl.github.io/spEDM/reference/ic.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"intersection cardinality — ic","text":"list xmap cross mapping performance varname name target variable method method cross mapping tau step time lag","code":""},{"path":"https://stscl.github.io/spEDM/reference/ic.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"intersection cardinality — ic","text":"Tao, P., Wang, Q., Shi, J., Hao, X., Liu, X., Min, B., Zhang, Y., Li, C., Cui, H., Chen, L., 2023. Detecting dynamical causality intersection cardinal concavity. Fundamental Research.","code":""},{"path":"https://stscl.github.io/spEDM/reference/ic.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"intersection cardinality — ic","text":"","code":"columbus = sf::read_sf(system.file(\"case/columbus.gpkg\", package=\"spEDM\")) # \\donttest{ ic(columbus,\"hoval\",\"crime\", E = 7, k = 15:25) #> The suggested E and k for variable crime is 7 and 18  # }"},{"path":"https://stscl.github.io/spEDM/reference/multiview.html","id":null,"dir":"Reference","previous_headings":"","what":"multiview embedding forecast — multiview","title":"multiview embedding forecast — multiview","text":"multiview embedding forecast","code":""},{"path":"https://stscl.github.io/spEDM/reference/multiview.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"multiview embedding forecast — multiview","text":"","code":"# S4 method for class 'sf' multiview(   data,   column,   target,   nvar,   E = 3,   k = E + 2,   tau = 1,   style = 1,   stack = FALSE,   lib = NULL,   pred = NULL,   dist.metric = \"L2\",   dist.average = TRUE,   top = NULL,   threads = detectThreads(),   detrend = TRUE,   nb = NULL )  # S4 method for class 'SpatRaster' multiview(   data,   column,   target,   nvar,   E = 3,   k = E + 2,   tau = 1,   style = 1,   stack = FALSE,   lib = NULL,   pred = NULL,   dist.metric = \"L2\",   dist.average = TRUE,   top = NULL,   threads = detectThreads(),   detrend = TRUE,   grid.coord = TRUE )"},{"path":"https://stscl.github.io/spEDM/reference/multiview.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"multiview embedding forecast — multiview","text":"data observation data. column name library variable. target name target variable. nvar number variable combinations. E (optional) embedding dimensions. k (optional) number nearest neighbors used. tau (optional) step spatial lags. style (optional) embedding style (0 includes current state, 1 excludes ). stack (optional) whether stack embeddings. lib (optional) libraries indices (input needed: vector - spatial vector, matrix - spatial raster). pred (optional) predictions indices (input requirement lib). dist.metric (optional) distance metric (L1: Manhattan, L2: Euclidean). dist.average (optional) whether average distance. top (optional) number reconstructions used MVE forecast. threads (optional) number threads use. detrend (optional) whether remove linear trend. nb (optional) neighbours list. grid.coord (optional) whether detrend using cell center coordinates (TRUE) row/column numbers (FALSE).","code":""},{"path":"https://stscl.github.io/spEDM/reference/multiview.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"multiview embedding forecast — multiview","text":"vector (input sf object) matrix","code":""},{"path":"https://stscl.github.io/spEDM/reference/multiview.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"multiview embedding forecast — multiview","text":"Ye H., G. Sugihara, 2016. Information leverage interconnected ecosystems: Overcoming curse dimensionality. Science 353:922-925.","code":""},{"path":"https://stscl.github.io/spEDM/reference/multiview.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"multiview embedding forecast — multiview","text":"","code":"columbus = sf::read_sf(system.file(\"case/columbus.gpkg\", package=\"spEDM\")) # \\donttest{ multiview(columbus,           column = c(\"inc\",\"crime\",\"open\",\"plumb\",\"discbd\"),           target = \"hoval\", nvar = 3) #>  [1]  18.8646054  22.4869617  21.1550738  -1.1253460  -9.1007114  -2.7903615 #>  [7]  -7.6201012  -6.6613986  -8.7202885  16.2907046 -13.4100870   5.5617166 #> [13]  -4.6242104  -6.0215133 -12.1983725  -9.3303243  14.4441917   2.2055448 #> [19]  -4.3641292  -6.0871013 -11.5193470   2.6235111  13.7585733  -8.7467063 #> [25]  -9.7543853  -4.1516025   3.8137697 -18.6397054 -12.1462767 -12.0658493 #> [31]  10.9218398  19.4799373  -8.1531852  16.5727910   0.7379578   8.5333685 #> [37] -15.5058094 -17.8177107  23.9793164  27.1593848  18.1874514  -2.9723211 #> [43]  -2.8697946  -8.5016198   1.2200571   5.7208429  15.1875343   6.5063233 #> [49]   0.2310141 # }"},{"path":"https://stscl.github.io/spEDM/reference/sc.test.html","id":null,"dir":"Reference","previous_headings":"","what":"spatial causality test — sc.test","title":"spatial causality test — sc.test","text":"spatial causality test","code":""},{"path":"https://stscl.github.io/spEDM/reference/sc.test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"spatial causality test — sc.test","text":"","code":"# S4 method for class 'sf' sc.test(   data,   cause,   effect,   k,   block = 3,   boot = 399,   seed = 42,   base = 2,   lib = NULL,   pred = NULL,   threads = detectThreads(),   detrend = TRUE,   normalize = FALSE,   progressbar = FALSE,   nb = NULL )  # S4 method for class 'SpatRaster' sc.test(   data,   cause,   effect,   k,   block = 3,   boot = 399,   seed = 42,   base = 2,   lib = NULL,   pred = NULL,   threads = detectThreads(),   detrend = TRUE,   normalize = FALSE,   progressbar = FALSE,   grid.coord = TRUE )"},{"path":"https://stscl.github.io/spEDM/reference/sc.test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"spatial causality test — sc.test","text":"data observation data. cause name causal variable. effect name effect variable. k (optional) number nearest neighbors used symbolization. block (optional) number blocks used spatial block bootstrap. boot (optional) number bootstraps perform. seed (optional) random seed. base (optional) logarithm base. lib (optional) libraries indices. pred (optional) predictions indices. threads (optional) number threads use. detrend (optional) whether remove linear trend. normalize (optional) whether normalize result. progressbar (optional) whether show progress bar. nb (optional) neighbours list. grid.coord (optional) whether detrend using cell center coordinates (TRUE) row/column numbers (FALSE).","code":""},{"path":"https://stscl.github.io/spEDM/reference/sc.test.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"spatial causality test — sc.test","text":"list sc statistic spatial causality varname names causal effect variable","code":""},{"path":"https://stscl.github.io/spEDM/reference/sc.test.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"spatial causality test — sc.test","text":"Herrera, M., Mur, J., & Ruiz, M. (2016). Detecting causal relationships spatial processes. Papers Regional Science, 95(3), 577–595.","code":""},{"path":"https://stscl.github.io/spEDM/reference/sc.test.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"spatial causality test — sc.test","text":"","code":"columbus = sf::read_sf(system.file(\"case/columbus.gpkg\", package=\"spEDM\")) # \\donttest{ sc.test(columbus,\"hoval\",\"crime\", k = 15) #> spatial causality test #> hoval -> crime: statistic = 1.114, p value = 0.574 #> crime -> hoval: statistic = 1.555, p value = 0 # }"},{"path":"https://stscl.github.io/spEDM/reference/simplex.html","id":null,"dir":"Reference","previous_headings":"","what":"simplex forecast — simplex","title":"simplex forecast — simplex","text":"simplex forecast","code":""},{"path":"https://stscl.github.io/spEDM/reference/simplex.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"simplex forecast — simplex","text":"","code":"# S4 method for class 'sf' simplex(   data,   column,   target,   E = 2:10,   k = E + 2,   tau = 1,   style = 1,   stack = FALSE,   lib = NULL,   pred = NULL,   dist.metric = \"L2\",   dist.average = TRUE,   threads = detectThreads(),   detrend = TRUE,   nb = NULL )  # S4 method for class 'SpatRaster' simplex(   data,   column,   target,   E = 2:10,   k = E + 2,   tau = 1,   style = 1,   stack = FALSE,   lib = NULL,   pred = NULL,   dist.metric = \"L2\",   dist.average = TRUE,   threads = detectThreads(),   detrend = TRUE,   grid.coord = TRUE,   embed.direction = 0 )"},{"path":"https://stscl.github.io/spEDM/reference/simplex.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"simplex forecast — simplex","text":"data observation data. column name library variable. target name target variable. E (optional) embedding dimensions. k (optional) number nearest neighbors used. tau (optional) step spatial lags. style (optional) embedding style (0 includes current state, 1 excludes ). stack (optional) whether stack embeddings. lib (optional) libraries indices (input needed: vector - spatial vector, matrix - spatial raster). pred (optional) predictions indices (input requirement lib). dist.metric (optional) distance metric (L1: Manhattan, L2: Euclidean). dist.average (optional) whether average distance. threads (optional) number threads use. detrend (optional) whether remove linear trend. nb (optional) neighbours list. grid.coord (optional) whether detrend using cell center coordinates (TRUE) row/column numbers (FALSE). embed.direction (optional) direction selector embeddings (0 returns directions, 1-8 correspond NW, N, NE, W, E, SW, S, SE).","code":""},{"path":"https://stscl.github.io/spEDM/reference/simplex.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"simplex forecast — simplex","text":"list xmap forecast performance varname name target variable method method cross mapping tau step time lag","code":""},{"path":"https://stscl.github.io/spEDM/reference/simplex.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"simplex forecast — simplex","text":"Sugihara G. May R. 1990. Nonlinear forecasting way distinguishing chaos measurement error time series. Nature, 344:734-741.","code":""},{"path":"https://stscl.github.io/spEDM/reference/simplex.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"simplex forecast — simplex","text":"","code":"columbus = sf::read_sf(system.file(\"case/columbus.gpkg\", package=\"spEDM\")) # \\donttest{ simplex(columbus,\"inc\",\"crime\") #> The suggested E and k for variable crime is 5 and 6  # }"},{"path":"https://stscl.github.io/spEDM/reference/slm.html","id":null,"dir":"Reference","previous_headings":"","what":"spatial logistic map — slm","title":"spatial logistic map — slm","text":"spatial logistic map","code":""},{"path":"https://stscl.github.io/spEDM/reference/slm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"spatial logistic map — slm","text":"","code":"# S4 method for class 'sf' slm(   data,   x = NULL,   y = NULL,   z = NULL,   k = 4,   step = 15,   alpha_x = 0.28,   alpha_y = 0.25,   alpha_z = 0.22,   beta_xy = 0.05,   beta_xz = 0.05,   beta_yx = 0.2,   beta_yz = 0.2,   beta_zx = 0.35,   beta_zy = 0.35,   threshold = Inf,   transient = 1,   interact = \"local\",   nb = NULL )  # S4 method for class 'SpatRaster' slm(   data,   x = NULL,   y = NULL,   z = NULL,   k = 4,   step = 15,   alpha_x = 0.28,   alpha_y = 0.25,   alpha_z = 0.22,   beta_xy = 0.05,   beta_xz = 0.05,   beta_yx = 0.2,   beta_yz = 0.2,   beta_zx = 0.35,   beta_zy = 0.35,   threshold = Inf,   transient = 1,   interact = \"local\" )"},{"path":"https://stscl.github.io/spEDM/reference/slm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"spatial logistic map — slm","text":"data observation data. x (optional) name first spatial variable. y (optional) name second spatial variable. z (optional) name third spatial variable. k (optional) number neighbors used. step (optional) number simulation time steps. alpha_x (optional) growth parameter x. alpha_y (optional) growth parameter y. alpha_z (optional) growth parameter y. beta_xy (optional) cross-inhibition x y. beta_xz (optional) cross-inhibition x z. beta_yx (optional) cross-inhibition y x. beta_yz (optional) cross-inhibition y z. beta_zx (optional) cross-inhibition z x. beta_zy (optional) cross-inhibition z y. threshold (optional) set NaN absolute value exceeds threshold. transient (optional) transients excluded results. interact (optional) type cross-variable interaction (local neighbors). nb (optional) neighbours list.","code":""},{"path":"https://stscl.github.io/spEDM/reference/slm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"spatial logistic map — slm","text":"list","code":""},{"path":"https://stscl.github.io/spEDM/reference/slm.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"spatial logistic map — slm","text":"Willeboordse, F.H., spatial logistic map simple prototype spatiotemporal chaos, Chaos, 533–540 (2003).","code":""},{"path":"https://stscl.github.io/spEDM/reference/slm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"spatial logistic map — slm","text":"","code":"columbus = sf::read_sf(system.file(\"case/columbus.gpkg\", package=\"spEDM\")) columbus$inc = sdsfun::normalize_vector(columbus$inc) slm(columbus,\"inc\") #> $x #>  [1] 0.8985452 0.8981079 0.8996913 0.9023158 0.9012219 0.8993983 0.9014626 #>  [8] 0.9011186 0.8995365 0.8998710 0.9016004 0.9012866 0.9013377 0.9012993 #> [15] 0.9013809 0.9016145 0.9011292 0.9007474 0.9009183 0.8921125 0.9012053 #> [22] 0.9011153 0.8965553 0.9003072 0.9015806 0.9015707 0.9009719 0.9016084 #> [29] 0.9015113 0.9003335 0.8988599 0.8961461 0.9011855 0.8993310 0.9005378 #> [36] 0.8983525 0.8996417 0.9010866 0.8981711 0.8921503 0.8963681 0.8953344 #> [43] 0.9005191 0.8994458 0.8999111 0.8982211 0.8981183 0.9004515 0.8985699 #>"},{"path":"https://stscl.github.io/spEDM/reference/smap.html","id":null,"dir":"Reference","previous_headings":"","what":"smap forecast — smap","title":"smap forecast — smap","text":"smap forecast","code":""},{"path":"https://stscl.github.io/spEDM/reference/smap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"smap forecast — smap","text":"","code":"# S4 method for class 'sf' smap(   data,   column,   target,   E = 3,   k = E + 2,   tau = 1,   style = 1,   stack = FALSE,   lib = NULL,   pred = NULL,   dist.metric = \"L2\",   dist.average = TRUE,   theta = c(0, 1e-04, 3e-04, 0.001, 0.003, 0.01, 0.03, 0.1, 0.3, 0.5, 0.75, 1, 1.5, 2, 3,     4, 6, 8),   threads = detectThreads(),   detrend = TRUE,   nb = NULL )  # S4 method for class 'SpatRaster' smap(   data,   column,   target,   E = 3,   k = E + 2,   tau = 1,   style = 1,   stack = FALSE,   lib = NULL,   pred = NULL,   dist.metric = \"L2\",   dist.average = TRUE,   theta = c(0, 1e-04, 3e-04, 0.001, 0.003, 0.01, 0.03, 0.1, 0.3, 0.5, 0.75, 1, 1.5, 2, 3,     4, 6, 8),   threads = detectThreads(),   detrend = TRUE,   grid.coord = TRUE,   embed.direction = 0 )"},{"path":"https://stscl.github.io/spEDM/reference/smap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"smap forecast — smap","text":"data observation data. column name library variable. target name target variable. E (optional) embedding dimensions. k (optional) number nearest neighbors used. tau (optional) step spatial lags. style (optional) embedding style (0 includes current state, 1 excludes ). stack (optional) whether stack embeddings. lib (optional) libraries indices (input needed: vector - spatial vector, matrix - spatial raster). pred (optional) predictions indices (input requirement lib). dist.metric (optional) distance metric (L1: Manhattan, L2: Euclidean). dist.average (optional) whether average distance. theta (optional) weighting parameter distances. threads (optional) number threads use. detrend (optional) whether remove linear trend. nb (optional) neighbours list. grid.coord (optional) whether detrend using cell center coordinates (TRUE) row/column numbers (FALSE). embed.direction (optional) direction selector embeddings (0 returns directions, 1-8 correspond NW, N, NE, W, E, SW, S, SE).","code":""},{"path":"https://stscl.github.io/spEDM/reference/smap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"smap forecast — smap","text":"list xmap forecast performance varname name target variable method method cross mapping","code":""},{"path":"https://stscl.github.io/spEDM/reference/smap.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"smap forecast — smap","text":"Sugihara G. 1994. Nonlinear forecasting classification natural time series. Philosophical Transactions: Physical Sciences Engineering, 348 (1688):477-495.","code":""},{"path":"https://stscl.github.io/spEDM/reference/smap.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"smap forecast — smap","text":"","code":"columbus = sf::read_sf(system.file(\"case/columbus.gpkg\", package=\"spEDM\")) # \\donttest{ smap(columbus,\"inc\",\"crime\",E = 5,k = 6) #> The suggested theta for variable crime is 4  # }"},{"path":[]},{"path":"https://stscl.github.io/spEDM/news/index.html","id":"new-1-9","dir":"Changelog","previous_headings":"","what":"new","title":"spEDM 1.9","text":"Introduce cross mapping raster data anisotropic embedding variable sliding window steps (#812). Extend capabilities incorporate mean-based stacked spatial cross-sectional embeddings cross mapping (#800).","code":""},{"path":"https://stscl.github.io/spEDM/news/index.html","id":"enhancements-1-9","dir":"Changelog","previous_headings":"","what":"enhancements","title":"spEDM 1.9","text":"Support spatial grid(raster) data detrending cell center coordinates row/column numbers (#815). Adjust Makevars track latest rcpparmadillo release armadillo updates improving build integration forward compatibility (#785).","code":""},{"path":"https://stscl.github.io/spEDM/news/index.html","id":"breaking-changes-1-9","dir":"Changelog","previous_headings":"","what":"breaking changes","title":"spEDM 1.9","text":"Harmonize parameter order across s4 generics spatial vector raster data (#817).","code":""},{"path":"https://stscl.github.io/spEDM/news/index.html","id":"spedm-18","dir":"Changelog","previous_headings":"","what":"spEDM 1.8","title":"spEDM 1.8","text":"CRAN release: 2025-08-31","code":""},{"path":"https://stscl.github.io/spEDM/news/index.html","id":"new-1-8","dir":"Changelog","previous_headings":"","what":"new","title":"spEDM 1.8","text":"Provide new mechanisms variable interaction spatial logistic map (#772). Introduce configurable distance metrics cross mapping (#761). Enable alternative styles spatial cross-sectional embedding (#755).","code":""},{"path":"https://stscl.github.io/spEDM/news/index.html","id":"enhancements-1-8","dir":"Changelog","previous_headings":"","what":"enhancements","title":"spEDM 1.8","text":"Safeguard transient removal logic spatial logistic map prevent index errors (#744). Adjust default E range simplex generic 2:10 support robust reconstruction state spaces (#739). Introduce multi-threading distance-related computations applicable improve runtime efficiency (#718). Display p-value annotation maximum library size cross mapping visualization legend (#710).","code":""},{"path":"https://stscl.github.io/spEDM/news/index.html","id":"breaking-changes-1-8","dir":"Changelog","previous_headings":"","what":"breaking changes","title":"spEDM 1.8","text":"Prevent unreliable predictions potentially alter results NaNs present cross mapping (#747). Rename coordinate columns population density case csv lon lat (#741).","code":""},{"path":"https://stscl.github.io/spEDM/news/index.html","id":"spedm-17","dir":"Changelog","previous_headings":"","what":"spEDM 1.7","title":"spEDM 1.7","text":"CRAN release: 2025-06-25","code":""},{"path":"https://stscl.github.io/spEDM/news/index.html","id":"new-1-7","dir":"Changelog","previous_headings":"","what":"new","title":"spEDM 1.7","text":"Provide R-level API vignette spatial logistic map (#609,#612).","code":""},{"path":"https://stscl.github.io/spEDM/news/index.html","id":"enhancements-1-7","dir":"Changelog","previous_headings":"","what":"enhancements","title":"spEDM 1.7","text":"Replace logical vectors integer index vectors lib pred simplex s-mapping forecasting sources (#632). Prevent duplicate generic registrations simplify method definitions (#627). Unify parameter descriptions lowercase (#570). Introduce confidence interval ribbon support plot method gccm results (#550).","code":""},{"path":"https://stscl.github.io/spEDM/news/index.html","id":"breaking-changes-1-7","dir":"Changelog","previous_headings":"","what":"breaking changes","title":"spEDM 1.7","text":"Refine randomization strategy spatial causality test (#643). Symbolization C++ functions now compute medians lib subset (#599). Users must now use detrend instead trend.rm (#559). Enable column parameter simplex() smap() rename columns parameter column multiview() (#565).","code":""},{"path":"https://stscl.github.io/spEDM/news/index.html","id":"bug-fixes-1-7","dir":"Changelog","previous_headings":"","what":"bug fixes","title":"spEDM 1.7","text":"Fix bug plot method gccm results legend labels correctly match corresponding line colors (#552).","code":""},{"path":"https://stscl.github.io/spEDM/news/index.html","id":"spedm-16","dir":"Changelog","previous_headings":"","what":"spEDM 1.6","title":"spEDM 1.6","text":"CRAN release: 2025-05-16","code":""},{"path":"https://stscl.github.io/spEDM/news/index.html","id":"new-1-6","dir":"Changelog","previous_headings":"","what":"new","title":"spEDM 1.6","text":"Enact fnn R API support false nearest neighbours method (#512). Integrate R API vignette geographical cross mapping cardinality (#455). Provide R-level API vignette spatial causality test (#403).","code":""},{"path":"https://stscl.github.io/spEDM/news/index.html","id":"enhancements-1-6","dir":"Changelog","previous_headings":"","what":"enhancements","title":"spEDM 1.6","text":"Enable custom legend texts colors plot method gccm results (#535). Reduce computational load vignettes (#476). Document overall structure usage spEDM dedicated vignette (#415). Create SSR vignette spatial cross-sectional data state-space reconstruction (#412). Include references algorithms spEDM (#367).","code":""},{"path":"https://stscl.github.io/spEDM/news/index.html","id":"breaking-changes-1-6","dir":"Changelog","previous_headings":"","what":"breaking changes","title":"spEDM 1.6","text":"Use non-NA spatial units lib/pred default (#499). Refine internal case data (#348).","code":""},{"path":"https://stscl.github.io/spEDM/news/index.html","id":"bug-fixes-1-6","dir":"Changelog","previous_headings":"","what":"bug fixes","title":"spEDM 1.6","text":"Patch memory error caused mismatch C++ (0-based) R (1-based) indexing (#480). Fix error non-matrix input grid-type handling due R matrix slicing (#474).","code":""},{"path":"https://stscl.github.io/spEDM/news/index.html","id":"spedm-15","dir":"Changelog","previous_headings":"","what":"spEDM 1.5","title":"spEDM 1.5","text":"CRAN release: 2025-03-12","code":""},{"path":"https://stscl.github.io/spEDM/news/index.html","id":"new-1-5","dir":"Changelog","previous_headings":"","what":"new","title":"spEDM 1.5","text":"Enable parallel.level parameter specify parallel granularity gccm R API (#310). Implement multiview function multiview embedding forecasting (MVE) method (#221).","code":""},{"path":"https://stscl.github.io/spEDM/news/index.html","id":"enhancements-1-5","dir":"Changelog","previous_headings":"","what":"enhancements","title":"spEDM 1.5","text":"Integrate lib parameter gccm R API library units selection (#278). Set default k E+2 gccm R API (#261). Eliminate redundant computations source C++ code level (#233). Add trend.rm option R API embedded, simplex, smap methods align gccm behavior (#191). Refactor indexing lag values embedding vector generation spatial lattice (#186,#184) grid data (#183,#181).","code":""},{"path":"https://stscl.github.io/spEDM/news/index.html","id":"breaking-changes-1-5","dir":"Changelog","previous_headings":"","what":"breaking changes","title":"spEDM 1.5","text":"Default plotting method places legend top-left corner plot now (#325). Refine simplex & smap output R side (#263).","code":""},{"path":"https://stscl.github.io/spEDM/news/index.html","id":"bug-fixes-1-5","dir":"Changelog","previous_headings":"","what":"bug fixes","title":"spEDM 1.5","text":"Fix bug R functions embedded, simplex, smap input data contains one attribute column (#246).","code":""},{"path":"https://stscl.github.io/spEDM/news/index.html","id":"spedm-14","dir":"Changelog","previous_headings":"","what":"spEDM 1.4","title":"spEDM 1.4","text":"CRAN release: 2025-02-10","code":""},{"path":"https://stscl.github.io/spEDM/news/index.html","id":"enhancements-1-4","dir":"Changelog","previous_headings":"","what":"enhancements","title":"spEDM 1.4","text":"Improve default spatial neighbors list generation spatial lattice data support sdsfun package (#159).","code":""},{"path":"https://stscl.github.io/spEDM/news/index.html","id":"breaking-changes-1-4","dir":"Changelog","previous_headings":"","what":"breaking changes","title":"spEDM 1.4","text":"Adjust behavior tau parameter C++ source code update R side API (#154).","code":""},{"path":"https://stscl.github.io/spEDM/news/index.html","id":"spedm-13","dir":"Changelog","previous_headings":"","what":"spEDM 1.3","title":"spEDM 1.3","text":"CRAN release: 2025-02-01","code":""},{"path":"https://stscl.github.io/spEDM/news/index.html","id":"new-1-3","dir":"Changelog","previous_headings":"","what":"new","title":"spEDM 1.3","text":"Implement smap function enable selection optimal theta parameter (#128). Add simplex function support selecting optimal embedding dimension variables (#98). Provide R-level API generating embeddings (#97).","code":""},{"path":"https://stscl.github.io/spEDM/news/index.html","id":"enhancements-1-3","dir":"Changelog","previous_headings":"","what":"enhancements","title":"spEDM 1.3","text":"Now bidirectional mapping gccm result uses full join structure organized R side (#118). Support calculating unidirectional mappings gccm function (#117). Relax gccm C++ source code libsizes minimum value constraint E+2 (#109). Provide complete GCCM workflow spatial lattice grid data gccm vignette (#100). Support testing causal links GCCM different E k cause effect variables (#96). Add thread settings gccm generic (#94). Add S-maps cross-prediction support gccm generic (#81).","code":""},{"path":"https://stscl.github.io/spEDM/news/index.html","id":"bug-fixes-1-3","dir":"Changelog","previous_headings":"","what":"bug fixes","title":"spEDM 1.3","text":"Resolve r crash caused invalid E #90 k #89 parameter settings gccm. Fix incorrect Pearson correlation calculation C++ code input contains NA (#83).","code":""},{"path":"https://stscl.github.io/spEDM/news/index.html","id":"spedm-12","dir":"Changelog","previous_headings":"","what":"spEDM 1.2","title":"spEDM 1.2","text":"CRAN release: 2025-01-14","code":""},{"path":"https://stscl.github.io/spEDM/news/index.html","id":"enhancements-1-2","dir":"Changelog","previous_headings":"","what":"enhancements","title":"spEDM 1.2","text":"Encapsulate gccm generic using S4 class (#72). Add options tau, k, progressbar gccm (#69). Add print plot s3 methods gccm result (#64).","code":""},{"path":"https://stscl.github.io/spEDM/news/index.html","id":"bug-fixes-1-2","dir":"Changelog","previous_headings":"","what":"bug fixes","title":"spEDM 1.2","text":"Fix bug gccm generic returns empty result input grid data contains NA values (#61).","code":""},{"path":"https://stscl.github.io/spEDM/news/index.html","id":"spedm-11","dir":"Changelog","previous_headings":"","what":"spEDM 1.1","title":"spEDM 1.1","text":"CRAN release: 2024-12-19","code":""},{"path":"https://stscl.github.io/spEDM/news/index.html","id":"bug-fixes-1-1","dir":"Changelog","previous_headings":"","what":"bug fixes","title":"spEDM 1.1","text":"Resolve CRAN auto check issues, significant API changes.","code":""},{"path":"https://stscl.github.io/spEDM/news/index.html","id":"spedm-10","dir":"Changelog","previous_headings":"","what":"spEDM 1.0","title":"spEDM 1.0","text":"CRAN release: 2024-12-16","code":""},{"path":"https://stscl.github.io/spEDM/news/index.html","id":"new-1-0","dir":"Changelog","previous_headings":"","what":"new","title":"spEDM 1.0","text":"Implement gccm generic spatial lattice grid data using modern C++.","code":""}]
