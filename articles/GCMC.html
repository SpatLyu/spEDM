<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Geographical Cross Mapping Cardinality (GCMC) ‚Ä¢ spEDM</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="‚Äùimage/svg+xml‚Äù" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Geographical Cross Mapping Cardinality (GCMC)">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">spEDM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><a class="dropdown-item" href="../articles/spEDM.html">Introduction to the spEDM package</a></li>
    <li><a class="dropdown-item" href="../articles/SSR.html">State Space Reconstruction (SSR)</a></li>
    <li><a class="dropdown-item" href="../articles/GCCM.html">Geographical Convergent Cross Mapping (GCCM)</a></li>
    <li><a class="dropdown-item" href="../articles/GCMC.html">Geographical Cross Mapping Cardinality (GCMC)</a></li>
    <li><a class="dropdown-item" href="../articles/SGC.html">Spatial Granger Causality Test (SGC)</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/stscl/spEDM/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Geographical Cross Mapping Cardinality (GCMC)</h1>
                        <h4 data-toc-skip class="author">Wenbo Lv</h4>
            
            <h4 data-toc-skip class="date">2025-05-12</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/stscl/spEDM/blob/main/vignettes/GCMC.Rmd" class="external-link"><code>vignettes/GCMC.Rmd</code></a></small>
      <div class="d-none name"><code>GCMC.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="research-notice">üìå Research Notice<a class="anchor" aria-label="anchor" href="#research-notice"></a>
</h2>
<p>The <code>GCMC</code> algorithm provided in this package is a
research method currently <strong>under peer review in the
<em>International Journal of Geographical Information Science
(IJGIS)</em> </strong>. We provide early access to its implementation
and a detailed vignette for reproducibility. Users should note that
<strong>methodological details may evolve</strong> before final
publication.</p>
</div>
<div class="section level2">
<h2 id="model-principles">Model principles<a class="anchor" aria-label="anchor" href="#model-principles"></a>
</h2>
<p>To measure causal associations in spatial cross-sectional data, GCMC
(Geographical Convergent Cross Mapping) employs a three-stage
procedure:</p>
<p><strong>Stage one</strong> involves reconstructing the state space.
Given two spatial variables, <span class="math inline">\(x\)</span> and
<span class="math inline">\(y\)</span>, this step requires determining a
suitable embedding dimension <span class="math inline">\(E\)</span> and
a spatial lag interval <span class="math inline">\(\tau\)</span>. For
each spatial location (unit) <span class="math inline">\(i\)</span>, the
attribute values from its spatial neighbors at lag orders <span class="math inline">\(1, 1+\tau, \dots, 1+(E-1)\tau\)</span> are
collected. These values are then summarized‚Äîcommonly using the mean‚Äîto
construct an embedding vector for each unit. Aggregating these vectors
across all spatial units results in the reconstructed state spaces,
denoted as <span class="math inline">\(E_x\)</span> and <span class="math inline">\(E_y\)</span>.</p>
<p><strong>Stage two</strong> constructs the Intersectional Cardinality
(IC) curve, which serves to evaluate causal strength. To measure whether
<span class="math inline">\(y\)</span> causally affects <span class="math inline">\(x\)</span>, one computes, for each <span class="math inline">\(k\)</span>, the overlap between the <span class="math inline">\(k\)</span> nearest neighbors of <span class="math inline">\(E_y\)</span> and the corresponding ‚Äúprojected‚Äù
neighbors traced through <span class="math inline">\(E_x\)</span>.
Specifically, for each point in <span class="math inline">\(E_x\)</span>, its <span class="math inline">\(k\)</span> nearest neighbors are identified, and
their mapped neighbors in <span class="math inline">\(E_y\)</span> are
compared with the direct neighbors of <span class="math inline">\(E_y\)</span>. The IC curve is formed by recording
the number of shared neighbors across a range of <span class="math inline">\(k = 1, 2, \dots, n\)</span>. This process can also
be reversed to test for causality from <span class="math inline">\(x\)</span> to <span class="math inline">\(y\)</span>.</p>
<p><strong>Stage three</strong> involves quantifying and validating the
strength of causal associations. The area under the IC curve (AUC)
provides a numerical measure of causal strength. To determine whether
the observed causal strength is statistically significant, a hypothesis
test is performed: the null assumes no causality, while the alternative
assumes its presence. The DeLong palcements method is applied to
evaluate the difference in AUCs under these hypotheses. It also yields
confidence intervals, supporting robust causal inference.</p>
</div>
<div class="section level2">
<h2 id="usage-examples">Usage examples<a class="anchor" aria-label="anchor" href="#usage-examples"></a>
</h2>
<div class="section level3">
<h3 id="an-example-of-spatial-lattice-data">An example of spatial lattice data<a class="anchor" aria-label="anchor" href="#an-example-of-spatial-lattice-data"></a>
</h3>
<p>Load the <code>spEDM</code> package and its county-level population
density data:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stscl.github.io/spEDM/">spEDM</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">popd_nb</span> <span class="op">=</span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/read.gal.html" class="external-link">read.gal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"case/popd_nb.gal"</span>,package <span class="op">=</span> <span class="st">"spEDM"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## Warning in spdep::read.gal(system.file("case/popd_nb.gal", package = "spEDM")):</span></span>
<span><span class="co">## neighbour object has 4 sub-graphs</span></span>
<span><span class="va">popd</span> <span class="op">=</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"case/popd.csv"</span>,package <span class="op">=</span> <span class="st">"spEDM"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## Rows: 2806 Columns: 7</span></span>
<span><span class="co">## ‚îÄ‚îÄ Column specification ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</span></span>
<span><span class="co">## Delimiter: ","</span></span>
<span><span class="co">## dbl (7): x, y, popd, elev, tem, pre, slope</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ‚Ñπ Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">## ‚Ñπ Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span>
<span><span class="va">popd_sf</span> <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="va">popd</span>, coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>,<span class="st">"y"</span><span class="op">)</span>, crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span></span>
<span><span class="va">popd_sf</span></span>
<span><span class="co">## Simple feature collection with 2806 features and 5 fields</span></span>
<span><span class="co">## Geometry type: POINT</span></span>
<span><span class="co">## Dimension:     XY</span></span>
<span><span class="co">## Bounding box:  xmin: 74.9055 ymin: 18.2698 xmax: 134.269 ymax: 52.9346</span></span>
<span><span class="co">## Geodetic CRS:  WGS 84</span></span>
<span><span class="co">## # A tibble: 2,806 √ó 6</span></span>
<span><span class="co">##     popd  elev   tem   pre slope          geometry</span></span>
<span><span class="co">##  * &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;       &lt;POINT [¬∞]&gt;</span></span>
<span><span class="co">##  1  780.     8  17.4 1528. 0.452 (116.912 30.4879)</span></span>
<span><span class="co">##  2  395.    48  17.2 1487. 0.842 (116.755 30.5877)</span></span>
<span><span class="co">##  3  261.    49  16.0 1456. 3.56  (116.541 30.7548)</span></span>
<span><span class="co">##  4  258.    23  17.4 1555. 0.932  (116.241 30.104)</span></span>
<span><span class="co">##  5  211.   101  16.3 1494. 3.34   (116.173 30.495)</span></span>
<span><span class="co">##  6  386.    10  16.6 1382. 1.65  (116.935 30.9839)</span></span>
<span><span class="co">##  7  350.    23  17.5 1569. 0.346 (116.677 30.2412)</span></span>
<span><span class="co">##  8  470.    22  17.1 1493. 1.88  (117.066 30.6514)</span></span>
<span><span class="co">##  9 1226.    11  17.4 1526. 0.208 (117.171 30.5558)</span></span>
<span><span class="co">## 10  137.   598  13.9 1458. 5.92  (116.208 30.8983)</span></span>
<span><span class="co">## # ‚Ñπ 2,796 more rows</span></span></code></pre></div>
<p>Run GCMC:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># temperature and population density</span></span>
<span><span class="va">g1</span> <span class="op">=</span> <span class="fu"><a href="../reference/gcmc.html">gcmc</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">popd_sf</span>, cause <span class="op">=</span> <span class="st">"tem"</span>, effect <span class="op">=</span> <span class="st">"popd"</span>, E <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">5</span><span class="op">)</span>,</span>
<span>          k <span class="op">=</span> <span class="fl">210</span>, nb <span class="op">=</span> <span class="va">popd_nb</span>, trend.rm <span class="op">=</span> <span class="cn">TRUE</span>, progressbar <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">g1</span></span>
<span><span class="co">##   neighbors tem-&gt;popd popd-&gt;tem</span></span>
<span><span class="co">## 1       210 0.7538776  0.197619</span></span>
<span></span>
<span><span class="co"># elevation and population density</span></span>
<span><span class="va">g2</span> <span class="op">=</span> <span class="fu"><a href="../reference/gcmc.html">gcmc</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">popd_sf</span>, cause <span class="op">=</span> <span class="st">"elev"</span>, effect <span class="op">=</span> <span class="st">"popd"</span>, E <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span>,</span>
<span>          k <span class="op">=</span> <span class="fl">210</span>, nb <span class="op">=</span> <span class="va">popd_nb</span>, trend.rm <span class="op">=</span> <span class="cn">TRUE</span>, progressbar <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">g2</span></span>
<span><span class="co">##   neighbors elev-&gt;popd popd-&gt;elev</span></span>
<span><span class="co">## 1       210  0.8355329  0.2065986</span></span>
<span></span>
<span><span class="co"># elevation and temperature</span></span>
<span><span class="va">g3</span> <span class="op">=</span> <span class="fu"><a href="../reference/gcmc.html">gcmc</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">popd_sf</span>, cause <span class="op">=</span> <span class="st">"elev"</span>, effect <span class="op">=</span> <span class="st">"tem"</span>, E <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>          k <span class="op">=</span> <span class="fl">210</span>, nb <span class="op">=</span> <span class="va">popd_nb</span>, trend.rm <span class="op">=</span> <span class="cn">TRUE</span>, progressbar <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">g3</span> <span class="co"># When there are insignificant results, we set spEDM to suppress output. This is not a bug.</span></span>
<span><span class="co">## [1] neighbors elev-&gt;tem tem-&gt;elev</span></span>
<span><span class="co">## &lt;0 rows&gt; (or 0-length row.names)</span></span>
<span><span class="va">g3</span><span class="op">$</span><span class="va">xmap</span></span>
<span><span class="co">##   neighbors x_xmap_y_mean x_xmap_y_sig x_xmap_y_upper x_xmap_y_lower</span></span>
<span><span class="co">## 1       210     0.5094785    0.7677155      0.5723751      0.4465818</span></span>
<span><span class="co">##   y_xmap_x_mean y_xmap_x_sig y_xmap_x_upper y_xmap_x_lower</span></span>
<span><span class="co">## 1     0.6279365 4.342088e-05      0.6892676      0.5666054</span></span></code></pre></div>
<p>Here we define two functions to process the results and plot the
causal association matrix.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">.process_xmap_result</span> <span class="op">=</span> \<span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">tempdf</span> <span class="op">=</span> <span class="va">g</span><span class="op">$</span><span class="va">xmap</span></span>
<span>  <span class="va">tempdf</span><span class="op">$</span><span class="va">x</span> <span class="op">=</span> <span class="va">g</span><span class="op">$</span><span class="va">varname</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="va">tempdf</span><span class="op">$</span><span class="va">y</span> <span class="op">=</span> <span class="va">g</span><span class="op">$</span><span class="va">varname</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span>  <span class="va">tempdf</span> <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">tempdf</span>, <span class="fl">1</span>, <span class="va">x</span>, <span class="va">y</span>,</span>
<span>                         <span class="va">x_xmap_y_mean</span>,<span class="va">x_xmap_y_sig</span>,</span>
<span>                         <span class="va">y_xmap_x_mean</span>,<span class="va">y_xmap_x_sig</span>,</span>
<span>                         <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">g1</span> <span class="op">=</span> <span class="va">tempdf</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,<span class="va">y_xmap_x_mean</span>,<span class="va">y_xmap_x_sig</span><span class="op">)</span><span class="op">|&gt;</span></span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/set_names.html" class="external-link">set_names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cause"</span>,<span class="st">"effect"</span>,<span class="st">"ca"</span>,<span class="st">"sig"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">g2</span> <span class="op">=</span> <span class="va">tempdf</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">y</span>,<span class="va">x</span>,<span class="va">x_xmap_y_mean</span>,<span class="va">x_xmap_y_sig</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/set_names.html" class="external-link">set_names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cause"</span>,<span class="st">"effect"</span>,<span class="st">"ca"</span>,<span class="st">"sig"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">g1</span>,<span class="va">g2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">plot_ca_matrix</span> <span class="op">=</span> \<span class="op">(</span><span class="va">.tbf</span>,<span class="va">legend_title</span> <span class="op">=</span> <span class="st">"Causal Association"</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">.tbf</span> <span class="op">=</span> <span class="va">.tbf</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sig_marker <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">sig</span> <span class="op">&lt;</span> <span class="fl">0.001</span> <span class="op">~</span> <span class="st">"***"</span>,</span>
<span>      <span class="va">sig</span> <span class="op">&lt;</span> <span class="fl">0.01</span>  <span class="op">~</span> <span class="st">"**"</span>,</span>
<span>      <span class="va">sig</span> <span class="op">&lt;</span> <span class="fl">0.05</span>  <span class="op">~</span> <span class="st">"*"</span>,</span>
<span>      .default <span class="op">=</span>  <span class="st">""</span></span>
<span>    <span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sig_marker <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">ca</span>,<span class="fl">3</span><span class="op">)</span>,<span class="va">sig_marker</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">fig</span> <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">.tbf</span>,</span>
<span>                        <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">effect</span>, y <span class="op">=</span> <span class="va">cause</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">ca</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span>slope <span class="op">=</span> <span class="fl">1</span>, intercept <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">sig_marker</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"black"</span>, family <span class="op">=</span> <span class="st">"serif"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Effect"</span>, y <span class="op">=</span> <span class="st">"Cause"</span>, fill <span class="op">=</span> <span class="va">legend_title</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_y_discrete</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"#9bbbb8"</span>, high <span class="op">=</span> <span class="st">"#256c68"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_equal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>      axis.text.x <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">0</span>, family <span class="op">=</span> <span class="st">"serif"</span><span class="op">)</span>,</span>
<span>      axis.text.y <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, family <span class="op">=</span> <span class="st">"serif"</span><span class="op">)</span>,</span>
<span>      axis.title.y <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, family <span class="op">=</span> <span class="st">"serif"</span><span class="op">)</span>,</span>
<span>      axis.title.x <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, family <span class="op">=</span> <span class="st">"serif"</span>,</span>
<span>                                           margin <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span>t <span class="op">=</span> <span class="fl">5.5</span>, unit <span class="op">=</span> <span class="st">"pt"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      legend.text <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"serif"</span><span class="op">)</span>,</span>
<span>      legend.title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"serif"</span><span class="op">)</span>,</span>
<span>      legend.background <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="cn">NA</span>, color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>,</span>
<span>      legend.direction <span class="op">=</span> <span class="st">"horizontal"</span>,</span>
<span>      legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>      legend.margin <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span>t <span class="op">=</span> <span class="fl">1</span>, r <span class="op">=</span> <span class="fl">0</span>, b <span class="op">=</span> <span class="fl">0</span>, l <span class="op">=</span> <span class="fl">0</span>, unit <span class="op">=</span> <span class="st">"pt"</span><span class="op">)</span>,</span>
<span>      legend.key.width <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">20</span>, <span class="st">"pt"</span><span class="op">)</span>,</span>
<span>      panel.grid <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      panel.border <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">fig</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Organize the results into a long table:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">g1</span>,<span class="va">g2</span>,<span class="va">g3</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">.process_xmap_result</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/list_c.html" class="external-link">list_rbind</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">res1</span></span>
<span><span class="co">##   cause effect        ca          sig</span></span>
<span><span class="co">## 1   tem   popd 0.7538776 1.110975e-19</span></span>
<span><span class="co">## 2  popd    tem 0.1976190 4.543832e-35</span></span>
<span><span class="co">## 3  elev   popd 0.8355329 9.586182e-44</span></span>
<span><span class="co">## 4  popd   elev 0.2065986 6.101271e-32</span></span>
<span><span class="co">## 5  elev    tem 0.6279365 4.342088e-05</span></span>
<span><span class="co">## 6   tem   elev 0.5094785 7.677155e-01</span></span></code></pre></div>
<p>Visualize the result:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot_ca_matrix</span><span class="op">(</span><span class="va">res1</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="../reference/figures/gcmc/fig1-1.png" alt="Figure 1. Causal associations among elevation, temperature, and population density."><div class="figcaption">
<strong>Figure 1</strong>. <strong>Causal
associations among elevation, temperature, and population
density.</strong>
</div>
</div>
</div>
<div class="section level3">
<h3 id="an-example-of-spatial-grid-data">An example of spatial grid data<a class="anchor" aria-label="anchor" href="#an-example-of-spatial-grid-data"></a>
</h3>
<p>Load the <code>spEDM</code> package and its farmland NPP data:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stscl.github.io/spEDM/">spEDM</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">npp</span> <span class="op">=</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"case/npp.tif"</span>, package <span class="op">=</span> <span class="st">"spEDM"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">npp</span></span>
<span><span class="co">## class       : SpatRaster </span></span>
<span><span class="co">## dimensions  : 404, 483, 5  (nrow, ncol, nlyr)</span></span>
<span><span class="co">## resolution  : 10000, 10000  (x, y)</span></span>
<span><span class="co">## extent      : -2625763, 2204237, 1877078, 5917078  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">## coord. ref. : CGCS2000_Albers </span></span>
<span><span class="co">## source      : npp.tif </span></span>
<span><span class="co">## names       :      npp,        pre,      tem,      elev,         hfp </span></span>
<span><span class="co">## min values  :   164.00,   384.3409, -47.8194, -122.2004,  0.03390418 </span></span>
<span><span class="co">## max values  : 16606.33, 23878.3555, 263.6938, 5350.4902, 44.90312195</span></span>
<span></span>
<span><span class="co"># To save the computation time, we will aggregate the data by 3 times</span></span>
<span><span class="va">npp</span> <span class="op">=</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">npp</span>, fact <span class="op">=</span> <span class="fl">3</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">npp</span></span>
<span><span class="co">## class       : SpatRaster </span></span>
<span><span class="co">## dimensions  : 135, 161, 5  (nrow, ncol, nlyr)</span></span>
<span><span class="co">## resolution  : 30000, 30000  (x, y)</span></span>
<span><span class="co">## extent      : -2625763, 2204237, 1867078, 5917078  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">## coord. ref. : CGCS2000_Albers </span></span>
<span><span class="co">## source(s)   : memory</span></span>
<span><span class="co">## names       :      npp,        pre,      tem,      elev,         hfp </span></span>
<span><span class="co">## min values  :   187.50,   390.3351, -47.8194, -110.1494,  0.04434316 </span></span>
<span><span class="co">## max values  : 15381.89, 23734.5330, 262.8576, 5217.6431, 42.68803711</span></span>
<span></span>
<span><span class="co"># Inspect NA values</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/global.html" class="external-link">global</a></span><span class="op">(</span><span class="va">npp</span>,<span class="st">"isNA"</span><span class="op">)</span></span>
<span><span class="co">##       isNA</span></span>
<span><span class="co">## npp  14815</span></span>
<span><span class="co">## pre  14766</span></span>
<span><span class="co">## tem  14766</span></span>
<span><span class="co">## elev 14760</span></span>
<span><span class="co">## hfp  14972</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">ncell</a></span><span class="op">(</span><span class="va">npp</span><span class="op">)</span></span>
<span><span class="co">## [1] 21735</span></span>
<span><span class="va">nnamat</span> <span class="op">=</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/coerce.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">npp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, wide <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">nnaindice</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">nnamat</span><span class="op">)</span>, arr.ind <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">nnaindice</span><span class="op">)</span></span>
<span><span class="co">## [1] 6920    2</span></span>
<span></span>
<span><span class="co"># Select 1500 non-NA pixels to predict:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">indices</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">nnaindice</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">1500</span>, replace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">libindice</span> <span class="op">=</span> <span class="va">nnaindice</span><span class="op">[</span><span class="op">-</span><span class="va">indices</span>,<span class="op">]</span></span>
<span><span class="va">predindice</span> <span class="op">=</span> <span class="va">nnaindice</span><span class="op">[</span><span class="va">indices</span>,<span class="op">]</span></span></code></pre></div>
<p>Run GCMC:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># precipitation and npp</span></span>
<span><span class="va">g1</span> <span class="op">=</span> <span class="fu"><a href="../reference/gcmc.html">gcmc</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">npp</span>, cause <span class="op">=</span> <span class="st">"pre"</span>, effect <span class="op">=</span> <span class="st">"npp"</span>, E <span class="op">=</span> <span class="fl">2</span>, k <span class="op">=</span> <span class="fl">270</span>,</span>
<span>          lib <span class="op">=</span> <span class="va">predindice</span>, pred <span class="op">=</span> <span class="va">predindice</span>, trend.rm <span class="op">=</span> <span class="cn">TRUE</span>, progressbar <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">g1</span></span>
<span><span class="co">## [1] neighbors pre-&gt;npp  npp-&gt;pre </span></span>
<span><span class="co">## &lt;0 rows&gt; (or 0-length row.names)</span></span>
<span><span class="va">g1</span><span class="op">$</span><span class="va">xmap</span></span>
<span><span class="co">##   neighbors x_xmap_y_mean x_xmap_y_sig x_xmap_y_upper x_xmap_y_lower</span></span>
<span><span class="co">## 1       270     0.5383539    0.1686404      0.5929617      0.4837461</span></span>
<span><span class="co">##   y_xmap_x_mean y_xmap_x_sig y_xmap_x_upper y_xmap_x_lower</span></span>
<span><span class="co">## 1     0.6088477 8.929335e-05      0.6632986      0.5543968</span></span>
<span></span>
<span><span class="co"># temperature and npp</span></span>
<span><span class="va">g2</span> <span class="op">=</span> <span class="fu"><a href="../reference/gcmc.html">gcmc</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">npp</span>, cause <span class="op">=</span> <span class="st">"tem"</span>, effect <span class="op">=</span> <span class="st">"npp"</span>, E <span class="op">=</span> <span class="fl">2</span>, k <span class="op">=</span> <span class="fl">270</span>,</span>
<span>          lib <span class="op">=</span> <span class="va">predindice</span>, pred <span class="op">=</span> <span class="va">predindice</span>, trend.rm <span class="op">=</span> <span class="cn">TRUE</span>, progressbar <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">g2</span></span>
<span><span class="co">##   neighbors  tem-&gt;npp  npp-&gt;tem</span></span>
<span><span class="co">## 1       270 0.6401509 0.6113992</span></span>
<span></span>
<span><span class="co"># precipitation and temperature</span></span>
<span><span class="va">g3</span> <span class="op">=</span> <span class="fu"><a href="../reference/gcmc.html">gcmc</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">npp</span>, cause <span class="op">=</span> <span class="st">"pre"</span>, effect <span class="op">=</span> <span class="st">"tem"</span>, E <span class="op">=</span> <span class="fl">2</span>, k <span class="op">=</span> <span class="fl">270</span>,</span>
<span>          lib <span class="op">=</span> <span class="va">predindice</span>, pred <span class="op">=</span> <span class="va">predindice</span>, trend.rm <span class="op">=</span> <span class="cn">TRUE</span>, progressbar <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">g3</span></span>
<span><span class="co">##   neighbors  pre-&gt;tem  tem-&gt;pre</span></span>
<span><span class="co">## 1       270 0.6800274 0.6381344</span></span></code></pre></div>
<p>Organize the results into a long table:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">g1</span>,<span class="va">g2</span>,<span class="va">g3</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">.process_xmap_result</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/list_c.html" class="external-link">list_rbind</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">res2</span></span>
<span><span class="co">##   cause effect        ca          sig</span></span>
<span><span class="co">## 1   pre    npp 0.6088477 8.929335e-05</span></span>
<span><span class="co">## 2   npp    pre 0.5383539 1.686404e-01</span></span>
<span><span class="co">## 3   tem    npp 0.6401509 2.548677e-07</span></span>
<span><span class="co">## 4   npp    tem 0.6113992 4.810113e-05</span></span>
<span><span class="co">## 5   pre    tem 0.6800274 1.305997e-11</span></span>
<span><span class="co">## 6   tem    pre 0.6381344 3.699711e-07</span></span></code></pre></div>
<p>Visualize the result:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot_ca_matrix</span><span class="op">(</span><span class="va">res2</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="../reference/figures/gcmc/fig2-1.png" alt="Figure 2. Causal associations among precipitation, temperature, and NPP."><div class="figcaption">
<strong>Figure 2</strong>. <strong>Causal
associations among precipitation, temperature, and NPP.</strong>
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://spatlyu.github.io/" class="external-link">Wenbo Lv</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
