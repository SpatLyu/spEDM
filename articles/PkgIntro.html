<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to the spEDM package (PkgIntro) • spEDM</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Introduction to the spEDM package (PkgIntro)">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">spEDM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.7</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><a class="dropdown-item" href="../articles/PkgIntro.html">Introduction to the spEDM package (PkgIntro)</a></li>
    <li><a class="dropdown-item" href="../articles/SSR.html">State Space Reconstruction (SSR)</a></li>
    <li><a class="dropdown-item" href="../articles/SLM.html">Spatial Logistic Map (SLM)</a></li>
    <li><a class="dropdown-item" href="../articles/GCCM.html">Geographical Convergent Cross Mapping (GCCM)</a></li>
    <li><a class="dropdown-item" href="../articles/GCMC.html">Geographical Cross Mapping Cardinality (GCMC)</a></li>
    <li><a class="dropdown-item" href="../articles/SCT.html">Spatial Causality Test (SCT)</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/stscl/spEDM/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Introduction to the spEDM package (PkgIntro)</h1>
                        <h4 data-toc-skip class="author">Wenbo Lv</h4>
            
            <h4 data-toc-skip class="date">2025-06-17</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/stscl/spEDM/blob/main/vignettes/PkgIntro.Rmd" class="external-link"><code>vignettes/PkgIntro.Rmd</code></a></small>
      <div class="d-none name"><code>PkgIntro.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The <em>spEDM</em> package is an open-source, computationally
efficient toolkit designed to provide a unified API for <strong>Spatial
Empirical Dynamic Modeling</strong>. It supports a suite of
prediction-based causal inference algorithms, including <em>spatial
(granger) causality test</em>, <em>geographically convergent cross
mapping</em>, and <em>geographical cross mapping cardinality</em>.</p>
<p>To support both learning and practical application, <em>spEDM</em>
offers four carefully curated spatial cross-sectional datasets, each
paired with a detailed example showcasing the use of key algorithms in
the package.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Install the stable version from <a href="https://CRAN.R-project.org/package=spEDM" class="external-link">CRAN</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"spEDM"</span>, dep <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Alternatively, you can install the development version from <a href="https://stscl.r-universe.dev/spEDM" class="external-link">R-universe</a> with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"spEDM"</span>,</span>
<span>                 repos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"https://stscl.r-universe.dev"</span>,</span>
<span>                           <span class="st">"https://cloud.r-project.org"</span><span class="op">)</span>,</span>
<span>                 dep <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h2>
<p>The <em>spEDM</em> package includes four illustrative datasets with
well-known causation to demonstrate key functionalities:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Columbus, OH</strong> dataset — A classic spatial dataset
widely used in spatial econometrics, included here for benchmarking and
demonstration purposes. <em>Data files</em>:
<code>columbus.gpkg</code></p></li>
<li><p><strong>Population density and its potential drivers in mainland
China</strong> — A county-level dataset capturing population density
alongside relevant socio-environmental drivers. <em>Data files</em>:
<code>popd.csv</code>, <code>popd_nb.gal</code></p></li>
<li><p><strong>Soil copper (Cu) contamination</strong> — A raster-based
dataset representing soil Cu concentrations, with associated layers on
nighttime light intensity and industrial density, useful for exploring
the influence of human activities on environmental pollution. <em>Data
files</em>: <code>cu.tif</code></p></li>
<li><p><strong>Farmland NPP and related variables</strong> — A raster
dataset capturing net primary productivity (NPP) of farmland, key
climatic variables, elevation, and human activity footprints across
mainland China, suitable for analyzing the interactions between
agricultural productivity, environmental conditions, and human
activities. <em>Data files</em>: <code>npp.tif</code></p></li>
</ol>
<p>These datasets can be loaded as shown below, including basic
visualization for raster data:</p>
<div class="section level3">
<h3 id="columbus-oh-spatial-analysis-dataset">Columbus OH spatial analysis dataset<a class="anchor" aria-label="anchor" href="#columbus-oh-spatial-analysis-dataset"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stscl.github.io/spEDM/">spEDM</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">columbus</span> <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">read_sf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"case/columbus.gpkg"</span>, package<span class="op">=</span><span class="st">"spEDM"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">columbus</span></span>
<span><span class="co">## Simple feature collection with 49 features and 6 fields</span></span>
<span><span class="co">## Geometry type: POLYGON</span></span>
<span><span class="co">## Dimension:     XY</span></span>
<span><span class="co">## Bounding box:  xmin: 5.874907 ymin: 10.78863 xmax: 11.28742 ymax: 14.74245</span></span>
<span><span class="co">## Projected CRS: Undefined Cartesian SRS with unknown unit</span></span>
<span><span class="co">## # A tibble: 49 × 7</span></span>
<span><span class="co">##    hoval   inc  crime  open plumb discbd                                     geom</span></span>
<span><span class="co">##    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;                                &lt;POLYGON&gt;</span></span>
<span><span class="co">##  1  80.5 19.5  15.7   2.85  0.217   5.03 ((8.624129 14.23698, 8.5597 14.74245, 8…</span></span>
<span><span class="co">##  2  44.6 21.2  18.8   5.30  0.321   4.27 ((8.25279 14.23694, 8.282758 14.22994, …</span></span>
<span><span class="co">##  3  26.4 16.0  30.6   4.53  0.374   3.89 ((8.653305 14.00809, 8.81814 14.00205, …</span></span>
<span><span class="co">##  4  33.2  4.48 32.4   0.394 1.19    3.7  ((8.459499 13.82035, 8.473408 13.83227,…</span></span>
<span><span class="co">##  5  23.2 11.3  50.7   0.406 0.625   2.83 ((8.685274 13.63952, 8.677577 13.72221,…</span></span>
<span><span class="co">##  6  28.8 16.0  26.1   0.563 0.254   3.78 ((9.401384 13.5504, 9.434411 13.69427, …</span></span>
<span><span class="co">##  7  75    8.44  0.178 0     2.40    2.74 ((8.037741 13.60752, 8.062716 13.60452,…</span></span>
<span><span class="co">##  8  37.1 11.3  38.4   3.48  2.74    2.89 ((8.247527 13.58651, 8.2795 13.5965, 8.…</span></span>
<span><span class="co">##  9  52.6 17.6  30.5   0.527 0.891   3.17 ((9.333297 13.27242, 9.671007 13.27361,…</span></span>
<span><span class="co">## 10  96.4 13.6  34.0   1.55  0.558   4.33 ((10.08251 13.03377, 10.0925 13.05275, …</span></span>
<span><span class="co">## # ℹ 39 more rows</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="county-level-population-density-in-mainland-china">County-level population density in mainland China<a class="anchor" aria-label="anchor" href="#county-level-population-density-in-mainland-china"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stscl.github.io/spEDM/">spEDM</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">popd_nb</span> <span class="op">=</span> <span class="fu">spdep</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/read.gal.html" class="external-link">read.gal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"case/popd_nb.gal"</span>,package <span class="op">=</span> <span class="st">"spEDM"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## Warning in spdep::read.gal(system.file("case/popd_nb.gal", package = "spEDM")):</span></span>
<span><span class="co">## neighbour object has 4 sub-graphs</span></span>
<span><span class="va">popd_nb</span></span>
<span><span class="co">## Neighbour list object:</span></span>
<span><span class="co">## Number of regions: 2806 </span></span>
<span><span class="co">## Number of nonzero links: 15942 </span></span>
<span><span class="co">## Percentage nonzero weights: 0.2024732 </span></span>
<span><span class="co">## Average number of links: 5.681397 </span></span>
<span><span class="co">## 4 disjoint connected subgraphs</span></span>
<span></span>
<span><span class="va">popd</span> <span class="op">=</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"case/popd.csv"</span>,package <span class="op">=</span> <span class="st">"spEDM"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## Rows: 2806 Columns: 7</span></span>
<span><span class="co">## ── Column specification ─────────────────────────────────────────────────────────</span></span>
<span><span class="co">## Delimiter: ","</span></span>
<span><span class="co">## dbl (7): x, y, popd, elev, tem, pre, slope</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ℹ Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span>
<span><span class="va">popd</span></span>
<span><span class="co">## # A tibble: 2,806 × 7</span></span>
<span><span class="co">##        x     y  popd  elev   tem   pre slope</span></span>
<span><span class="co">##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">##  1  117.  30.5  780.     8  17.4 1528. 0.452</span></span>
<span><span class="co">##  2  117.  30.6  395.    48  17.2 1487. 0.842</span></span>
<span><span class="co">##  3  117.  30.8  261.    49  16.0 1456. 3.56 </span></span>
<span><span class="co">##  4  116.  30.1  258.    23  17.4 1555. 0.932</span></span>
<span><span class="co">##  5  116.  30.5  211.   101  16.3 1494. 3.34 </span></span>
<span><span class="co">##  6  117.  31.0  386.    10  16.6 1382. 1.65 </span></span>
<span><span class="co">##  7  117.  30.2  350.    23  17.5 1569. 0.346</span></span>
<span><span class="co">##  8  117.  30.7  470.    22  17.1 1493. 1.88 </span></span>
<span><span class="co">##  9  117.  30.6 1226.    11  17.4 1526. 0.208</span></span>
<span><span class="co">## 10  116.  30.9  137.   598  13.9 1458. 5.92 </span></span>
<span><span class="co">## # ℹ 2,796 more rows</span></span>
<span></span>
<span><span class="va">popd_sf</span> <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="va">popd</span>, coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>,<span class="st">"y"</span><span class="op">)</span>, crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span></span>
<span><span class="va">popd_sf</span></span>
<span><span class="co">## Simple feature collection with 2806 features and 5 fields</span></span>
<span><span class="co">## Geometry type: POINT</span></span>
<span><span class="co">## Dimension:     XY</span></span>
<span><span class="co">## Bounding box:  xmin: 74.9055 ymin: 18.2698 xmax: 134.269 ymax: 52.9346</span></span>
<span><span class="co">## Geodetic CRS:  WGS 84</span></span>
<span><span class="co">## # A tibble: 2,806 × 6</span></span>
<span><span class="co">##     popd  elev   tem   pre slope          geometry</span></span>
<span><span class="co">##  * &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;       &lt;POINT [°]&gt;</span></span>
<span><span class="co">##  1  780.     8  17.4 1528. 0.452 (116.912 30.4879)</span></span>
<span><span class="co">##  2  395.    48  17.2 1487. 0.842 (116.755 30.5877)</span></span>
<span><span class="co">##  3  261.    49  16.0 1456. 3.56  (116.541 30.7548)</span></span>
<span><span class="co">##  4  258.    23  17.4 1555. 0.932  (116.241 30.104)</span></span>
<span><span class="co">##  5  211.   101  16.3 1494. 3.34   (116.173 30.495)</span></span>
<span><span class="co">##  6  386.    10  16.6 1382. 1.65  (116.935 30.9839)</span></span>
<span><span class="co">##  7  350.    23  17.5 1569. 0.346 (116.677 30.2412)</span></span>
<span><span class="co">##  8  470.    22  17.1 1493. 1.88  (117.066 30.6514)</span></span>
<span><span class="co">##  9 1226.    11  17.4 1526. 0.208 (117.171 30.5558)</span></span>
<span><span class="co">## 10  137.   598  13.9 1458. 5.92  (116.208 30.8983)</span></span>
<span><span class="co">## # ℹ 2,796 more rows</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="soil-cu-heavy-metal-contamination">Soil Cu heavy metal contamination<a class="anchor" aria-label="anchor" href="#soil-cu-heavy-metal-contamination"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stscl.github.io/spEDM/">spEDM</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">cu</span> <span class="op">=</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"case/cu.tif"</span>, package<span class="op">=</span><span class="st">"spEDM"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cu</span></span>
<span><span class="co">## class       : SpatRaster </span></span>
<span><span class="co">## size        : 131, 125, 3  (nrow, ncol, nlyr)</span></span>
<span><span class="co">## resolution  : 5000, 5000  (x, y)</span></span>
<span><span class="co">## extent      : 360000, 985000, 1555000, 2210000  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">## coord. ref. : North_American_1983_Albers </span></span>
<span><span class="co">## source      : cu.tif </span></span>
<span><span class="co">## names       :         cu, industry, ntl </span></span>
<span><span class="co">## min values  :   1.201607,    0.000,   0 </span></span>
<span><span class="co">## max values  : 319.599274,    0.615,  63</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>terra.pal <span class="op">=</span> <span class="fu">grDevices</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">terrain.colors</a></span><span class="op">(</span><span class="fl">100</span>,rev <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cu</span>, nc <span class="op">=</span> <span class="fl">3</span>,</span>
<span>            mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">4</span><span class="op">)</span>,</span>
<span>            oma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">4</span><span class="op">)</span>,</span>
<span>            axes <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>            legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="../reference/figures/pkgintro/cu-1.png" alt="Figure 1. Maps of soil Cu contamination, the density of industrial pollutants and nightlight."><div class="figcaption">
<strong>Figure 1</strong>. Maps of soil Cu
contamination, the density of industrial pollutants and
nightlight.</div>
</div>
</div>
<div class="section level3">
<h3 id="farmland-npp-and-related-variables-in-mainland-china">Farmland NPP and related variables in mainland China<a class="anchor" aria-label="anchor" href="#farmland-npp-and-related-variables-in-mainland-china"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stscl.github.io/spEDM/">spEDM</a></span><span class="op">)</span></span>
<span><span class="va">npp</span> <span class="op">=</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"case/npp.tif"</span>, package <span class="op">=</span> <span class="st">"spEDM"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">npp</span></span>
<span><span class="co">## class       : SpatRaster </span></span>
<span><span class="co">## size        : 404, 483, 5  (nrow, ncol, nlyr)</span></span>
<span><span class="co">## resolution  : 10000, 10000  (x, y)</span></span>
<span><span class="co">## extent      : -2625763, 2204237, 1877078, 5917078  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">## coord. ref. : CGCS2000_Albers </span></span>
<span><span class="co">## source      : npp.tif </span></span>
<span><span class="co">## names       :      npp,        pre,      tem,      elev,         hfp </span></span>
<span><span class="co">## min values  :   164.00,   384.3409, -47.8194, -122.2004,  0.03390418 </span></span>
<span><span class="co">## max values  : 16606.33, 23878.3555, 263.6938, 5350.4902, 44.90312195</span></span>
<span></span>
<span><span class="co"># directly visualize the raster layer</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>terra.pal <span class="op">=</span> <span class="fu">grDevices</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">terrain.colors</a></span><span class="op">(</span><span class="fl">100</span>,rev <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">npp</span>, nc <span class="op">=</span> <span class="fl">2</span>,</span>
<span>            axes <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>            legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="../reference/figures/pkgintro/npp-1.png" alt="Figure 2. Maps of farmland NPP and climate factors."><div class="figcaption">
<strong>Figure 2</strong>. Maps of farmland NPP
and climate factors.</div>
</div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># add China's land borders and the ten-dash line in the South China Sea</span></span>
<span></span>
<span><span class="co"># install.packages("geocn",</span></span>
<span><span class="co">#                  repos = c("https://stscl.r-universe.dev",</span></span>
<span><span class="co">#                            "https://cloud.r-project.org"),</span></span>
<span><span class="co">#                  dep = TRUE)</span></span>
<span></span>
<span><span class="va">cn_border</span> <span class="op">=</span> <span class="fu">geocn</span><span class="fu">::</span><span class="fu">load_cn_border</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/vect.html" class="external-link">vect</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/project.html" class="external-link">project</a></span><span class="op">(</span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/crs.html" class="external-link">crs</a></span><span class="op">(</span><span class="va">npp</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nlyr</a></span><span class="op">(</span><span class="va">npp</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cn_border</span>, lwd <span class="op">=</span> <span class="fl">1.5</span>, main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">npp</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span>
<span>              col <span class="op">=</span> <span class="st">"grey40"</span>, axes <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">npp</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, axes <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>              legend <span class="op">=</span> <span class="cn">FALSE</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="float">
<img src="../reference/figures/pkgintro/npp2-1.png" alt="Figure 3. Maps of farmland NPP and climate factors."><div class="figcaption">
<strong>Figure 3</strong>. Maps of farmland NPP
and climate factors.</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p>Users can refer to several additional vignettes for more detailed
examples of using <em>spEDM</em>, namely:</p>
<table class="table">
<colgroup>
<col width="50%">
<col width="50%">
</colgroup>
<thead><tr class="header">
<th><em>Method</em></th>
<th><em>Vignette</em></th>
</tr></thead>
<tbody>
<tr class="odd">
<td>State Space Reconstruction</td>
<td><a href="https://stscl.github.io/spEDM/articles/SSR.html">SSR</a></td>
</tr>
<tr class="even">
<td>Spatial Logistic Map</td>
<td><a href="https://stscl.github.io/spEDM/articles/SLM.html">SLM</a></td>
</tr>
<tr class="odd">
<td>Geographical Convergent Cross Mapping</td>
<td><a href="https://stscl.github.io/spEDM/articles/GCCM.html">GCCM</a></td>
</tr>
<tr class="even">
<td>Geographical Cross Mapping Cardinality</td>
<td><a href="https://stscl.github.io/spEDM/articles/GCMC.html">GCMC</a></td>
</tr>
<tr class="odd">
<td>Spatial Causality Test</td>
<td><a href="https://stscl.github.io/spEDM/articles/SCT.html">SCT</a></td>
</tr>
</tbody>
</table>
<p>In addition to the spatial extensions provided by <em>spEDM</em>,
several other R packages support Empirical Dynamic Modeling (EDM) for
<strong>time series data</strong>:</p>
<ul>
<li>
<strong><a href="https://cran.r-project.org/package=rEDM" class="external-link">rEDM</a></strong>: A
foundational EDM package implementing simplex projection, S-map, and
convergent cross mapping (CCM), widely used for analyzing nonlinear time
series dynamics.</li>
<li>
<strong><a href="https://cran.r-project.org/package=multispatialCCM" class="external-link">multispatialCCM</a></strong>:
Implements CCM for collections of short time series using bootstrapping,
enabling causal inference across replicated or multi-site time
series.</li>
<li>
<strong><a href="https://edm-developers.github.io/fastEDM-r/" class="external-link">fastEDM</a></strong>:
A high-performance EDM package with a multi-threaded C++ backend. It
supports large-scale time series analysis, handles panel data, and
provides robust options for dealing with missing values using
delay-tolerant algorithms or data exclusion.</li>
</ul>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Takens, F. (1981). Detecting strange attractors in turbulence.
Dynamical Systems and Turbulence, Warwick 1980, 366–381. <a href="https://doi.org/10.1007/bfb0091924" class="external-link uri">https://doi.org/10.1007/bfb0091924</a></p>
<p>Mañé, R. (1981). On the dimension of the compact invariant sets of
certain non-linear maps. Dynamical Systems and Turbulence, Warwick 1980,
230–242. <a href="https://doi.org/10.1007/bfb0091916" class="external-link uri">https://doi.org/10.1007/bfb0091916</a></p>
<p>Willeboordse, F.H., 2003. The spatial logistic map as a simple
prototype for spatiotemporal chaos. Chaos: An Interdisciplinary Journal
of Nonlinear Science 13, 533–540. <a href="https://doi.org/10.1063/1.1568692" class="external-link uri">https://doi.org/10.1063/1.1568692</a></p>
<p>Herrera, M., Mur, J., &amp; Ruiz, M. (2016). Detecting causal
relationships between spatial processes. Papers in Regional Science,
95(3), 577–595. <a href="https://doi.org/10.1111/pirs.12144" class="external-link uri">https://doi.org/10.1111/pirs.12144</a></p>
<p>Gao, B., Yang, J., Chen, Z., Sugihara, G., Li, M., Stein, A., Kwan,
M.-P., &amp; Wang, J. (2023). Causal inference from cross-sectional
earth system data with geographical convergent cross mapping. Nature
Communications, 14(1). <a href="https://doi.org/10.1038/s41467-023-41619-6" class="external-link uri">https://doi.org/10.1038/s41467-023-41619-6</a></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://spatlyu.github.io/" class="external-link">Wenbo Lv</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
